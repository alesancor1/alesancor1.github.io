{"componentChunkName":"component---node-modules-nehalist-gatsby-theme-nehalem-src-templates-posts-tsx","path":"/","result":{"pageContext":{"posts":[{"id":"d9173b9f-6d39-5548-ad78-aa36c7b3d5b0","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2}],"frontmatter":{"title":"Creating a Helm Chart for a simple NodeJS App","path":"/simple-app-helm","tags":["Guide","Mid-level","Helm","Kubernetes"],"excerpt":"Steps on how to create a chart for a simple NodeJS app, connected to a MongoDB host and exposing its endpoints through a Kubernetes service templated with Helm.","created":"2022-02-13T04:12:00.000Z","createdPretty":"13 February, 2022","updated":"2022-02-13T00:00:00.000Z","updatedPretty":"13 February, 2022","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABlElEQVQoz3WQyy8DURjF5w9DJJ7Fwh9g1RLv58aCeG2olYpqF8pCGyFELYimM+2QoNWUamhFUE0XTVsSQVvRO3PMvc1MtPiSM/fmm98597uX6/U2oFw9nnq2dnvqoHdXYMqnx9rNHNr5KnQKNRqjcj/F/RVI1eWpxWyghwUdPm3Al3Rj824JS1djGBRb2GF/+UoC+7yNinToF5uYYeS4FWLCCcftAoyBPjjvbbCEJ2BwV2JAbGYs9ZQEFps6Zfw6dPDVDKbXpPvx0zbw8W0EU0fwJnYRSAswXY5qT0FZylGvmsOpP+g1ppW3MitXct6v4PrFjyx5h1qFrwJCFyFIIHh8jeAgZoc1PIkZv4F5aQ4Vtx9bRzhzhuRHHJ8krwUoTphNFth2rFgNLsJsWcbw0DCM80akk88a9kU+mTeUOcHewxo4lJUkE+UrI5vPIhqJInB9jq1LOxy7Dgi8AJfbhVw+pxAyiETK7eBoQFESZFlmTXVVK/OWwW0qUtL7yVKvmvNrwhJQkpjoJAVSgCwVe/8dTOsbjTs6LkHSdvUAAAAASUVORK5CYII=","aspectRatio":2.1186440677966103,"src":"/static/5cd3d231d17fc34575c02983e9d884ae/0853f/cover.png","srcSet":"/static/5cd3d231d17fc34575c02983e9d884ae/14156/cover.png 125w,\n/static/5cd3d231d17fc34575c02983e9d884ae/d6e47/cover.png 250w,\n/static/5cd3d231d17fc34575c02983e9d884ae/0853f/cover.png 500w,\n/static/5cd3d231d17fc34575c02983e9d884ae/ce627/cover.png 750w,\n/static/5cd3d231d17fc34575c02983e9d884ae/9dbcf/cover.png 1000w,\n/static/5cd3d231d17fc34575c02983e9d884ae/3e265/cover.png 2800w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<style>\n    summary {\n        cursor: pointer;\n    }\n</style>\n<blockquote>\n<p><strong>NOTE</strong>: This guide will assume you have a basic understanding of Helm and Kubernetes and know how to run and manage a cluster. If you haven't already read my post about <a href=\"/helm-fundamentals\">Helm fundamentals</a>, I encourage you to read it first.</p>\n<p>All the code in this guide is available on <a href=\"https://github.com/alesancor1/Blog-Projects/tree/main/guides/simple-app-helm\">GitHub</a></p>\n</blockquote>\n<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>For this guide, we will be deploying the simple NodeJS we build in a previous post, feel free to go <a href=\"/create-simple-app\">check it out</a> first. We will go through all the steps to set up our simple NodeJS app inside a Kubernetes cluster.</p>\n<blockquote>\n<p>This guide is parallel to the <a href=\"/simple-app-kubernetes\">Deploying a simple NodeJS App in kubernetes</a> guide, so you can open both posts and compare them, since both posts will follow the same exact structure.</p>\n</blockquote>\n<p>Unlike kubernetes, before starting to write manifests file like crazy, we first need to create our Helm chart with <code class=\"language-text\">helm create</code> command as explained in the <strong>Helm fundamentals</strong> post. Once created, we can start templating and installing dependencies in our chart.</p>\n<h2 id=\"creating-the-database-manifests\" style=\"position:relative;\"><a href=\"#creating-the-database-manifests\" aria-label=\"creating the database manifests permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the Database manifests</h2>\n<p>For the database we will not template the k8s manifests, since there are already created charts in <a href=\"https://artifacthub.io/\">Artifact Hub</a>. We will use the <strong>mongodb chart</strong> from there and configure our <code class=\"language-text\">values.yaml</code> file to adapt it to our needs.</p>\n<p>This way, our <code class=\"language-text\">Chart.yaml</code> file will contain the following under the <code class=\"language-text\">dependencies</code> field:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">...</span>\n<span class=\"token key atrule\">dependencies</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> mongodb\n    <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"*\"</span>\n    <span class=\"token key atrule\">repository</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"https://charts.bitnami.com/bitnami\"</span>\n    <span class=\"token key atrule\">alias</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db</code></pre></div>\n<p>Values will contain the <strong>fields overrides</strong> for the <em>name</em>, <em>namespace</em> and <em>auth</em> values (our app connects to a MongoDB without authentication, so we need to disable it).</p>\n<details>\n<summary> <b>Show values</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># Values.yaml</span>\n<span class=\"token punctuation\">...</span>\n<span class=\"token comment\"># DB Configs</span>\n<span class=\"token key atrule\">simple-db</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">fullnameOverride</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">nameOverride</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">auth</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n\n<span class=\"token key atrule\">global</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">namespaceOverride</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app</code></pre></div>\n</div></details>\n<blockquote>\n<p>Note we are naming the release <em>simple-db</em> through the <code class=\"language-text\">alias</code> field in dependencies, this let us override the chart values using that key inside <code class=\"language-text\">values.yaml</code>. You can check the docs for the MongoDB chart <a href=\"https://artifacthub.io/packages/helm/bitnami/mongodb\">here</a>.</p>\n</blockquote>\n<h2 id=\"creating-the-app-manifests\" style=\"position:relative;\"><a href=\"#creating-the-app-manifests\" aria-label=\"creating the app manifests permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the App manifests</h2>\n<p>Now we have to create our app's <strong>manifest files</strong>, just like we would normally do in kubernetes. However, this time we will use <strong>Helm templates</strong> along the <code class=\"language-text\">values.yaml</code> file to generate them.</p>\n<h3 id=\"service\" style=\"position:relative;\"><a href=\"#service\" aria-label=\"service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Service</h3>\n<p>Since we want our app to be deployed in both <strong>production</strong> and <strong>development</strong> environments, we usually would need to create to separate manifests for the service. Helm solves that issue thanks to the <strong>templating system</strong>, so we can conditionally add fields to our manifest depending on a value in the <code class=\"language-text\">values.yaml</code> file.</p>\n<p>We will use the <code class=\"language-text\">node_env</code> value to create the manifest for a production or a development environment:</p>\n<details>\n<summary> <b>Show template</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> if eq .Values.node_env \"development\" <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort\n  <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> end <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> if eq .Values.node_env \"development\" <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> end <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n</div></details>\n<blockquote>\n<p>When templating, you can run the <code class=\"language-text\">helm install</code> command with the <code class=\"language-text\">--dry-run</code> flag to <strong>simulate</strong> the installation and print the resulting manifests that will be applied. Don't forget to run <code class=\"language-text\">helm dep up</code> if your chart has any dependencies</p>\n</blockquote>\n<h3 id=\"deployment\" style=\"position:relative;\"><a href=\"#deployment\" aria-label=\"deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment</h3>\n<p>Just like we have done for the service, we will now create the deployment template. We will use the <strong>Values</strong> object to get the values and assign them to our container's environment variables so we can make our app as configurable as possible.</p>\n<details>\n<summary> <b>Show template</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> PORT\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"{{ .Values.port }}\"</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> DB_HOST\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.db_host <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> DB_PORT\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"{{ .Values.db_port }}\"</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> DB_NAME\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.db_name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> alesancor1/simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.AppVersion <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> Always\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n              <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n          <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 300Mi\n            <span class=\"token key atrule\">limits</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 500Mi</code></pre></div>\n</div></details>\n<p>We are using the <em>port</em>, <em>db_host</em>, <em>db_port</em>, <em>db_name</em> values from the <code class=\"language-text\">values.yaml</code> file to configure our container's environment variables, so we need to provide some default values for them:</p>\n<details>\n<summary> <b>Show values</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># Values.yaml</span>\n\n<span class=\"token comment\"># App Configs</span>\n<span class=\"token key atrule\">node_env</span><span class=\"token punctuation\">:</span> development\n<span class=\"token key atrule\">db_host</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n<span class=\"token key atrule\">db_port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">27017</span>\n<span class=\"token key atrule\">db_name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n<span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n<span class=\"token punctuation\">...</span></code></pre></div>\n</div></details>\n<blockquote>\n<p>We are setting those values by <strong>default</strong>, they can be <strong>overriden</strong> when installing the chart through the <code class=\"language-text\">-f &lt;file></code> or the <code class=\"language-text\">--set</code> flags of the <code class=\"language-text\">helm install</code> command.</p>\n</blockquote>\n<h2 id=\"running-locally-on-a-single-node-cluster\" style=\"position:relative;\"><a href=\"#running-locally-on-a-single-node-cluster\" aria-label=\"running locally on a single node cluster permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running locally on a single node cluster</h2>\n<p>In order to run in a local development environment, we just need to run the <strong>helm install</strong> command. We can override the default values with a new <strong>yaml</strong> file or directly through the <strong>command line</strong>. Since by default it will install for a <strong>development</strong> environment, tthere's no real need to override values, so we can directly run helm install on our chart. Remember to create the namespace before installing it:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$   kubectl create ns simple-app\n$   helm <span class=\"token function\">install</span> simple-app <span class=\"token builtin class-name\">.</span></code></pre></div>\n<p>If you performed all the steps correctly (remember to run only local services manifests), you should be able to see the app running on <a href=\"http://localhost:3300\">http://localhost:3300</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a60d624ca06590f5c59d77185c6194c0/f2b95/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAt0lEQVQI10WLywqCQBSGfaZaREQKoVBCi3IVtOldAy8zk7pIMrzNnJlGqN6h4yh0+M7t//mt3eniBue1f5w73oRtcLyZ7Y7K/zAsNtuVf1juA4tlOUuzkNBrGIcJiQiLDQlLp8luMR2ICI3poNA0z+9FVjys7wfrDSCeZdnWjeBcCoGvUkpKiQ0Seq1xdW2LVt9rlHnXgBCWUi/81UtVVc07DgLG0BBGb5hS6x6ljnO0tAlLEOj+ALCBqekYjRs7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"result\"\n        src=\"/static/a60d624ca06590f5c59d77185c6194c0/c1b63/result.png\"\n        srcset=\"/static/a60d624ca06590f5c59d77185c6194c0/5a46d/result.png 300w,\n/static/a60d624ca06590f5c59d77185c6194c0/0a47e/result.png 600w,\n/static/a60d624ca06590f5c59d77185c6194c0/c1b63/result.png 1200w,\n/static/a60d624ca06590f5c59d77185c6194c0/f2b95/result.png 1515w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"production-environments-dns-and-tls-configuration\" style=\"position:relative;\"><a href=\"#production-environments-dns-and-tls-configuration\" aria-label=\"production environments dns and tls configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Production environments: DNS and TLS configuration</h2>\n<p>For production environments, we will configure a <strong>DNS record</strong> pointing to the service. We will also configure a TLS certificate and a certificate signing request. For doing that, we will use <strong>Project Contour</strong> and <strong>Cert-Manager</strong> APIs, which simplifies the process. Since they are not native, first thing we need to do is installing them by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$    kubectl apply -f https://projectcontour.io/quickstart/contour.yaml\n$    kubectl apply -f https://github.com/jetstack/cert-manager/releases/download/v1.1.0/cert-manager.yaml</code></pre></div>\n<blockquote>\n<p><strong>Project Contour</strong> provide a Load Balancer service that will be our reverse proxy. Be sure to obtain its <strong>external IP</strong> and configure an <strong>A record</strong> in your <strong>NS zone</strong> pointing to that IP. The External IP can be obtained running <code class=\"language-text\">kubectl get -n projectcontour service envoy</code> (it takes a while to be ready).</p>\n<p>Be sure to set the <code class=\"language-text\">node_env</code> value to <code class=\"language-text\">production</code> when installing the chart.</p>\n</blockquote>\n<h3 id=\"issuer-and-clusterissuer\" style=\"position:relative;\"><a href=\"#issuer-and-clusterissuer\" aria-label=\"issuer and clusterissuer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Issuer and ClusterIssuer</h3>\n<p>Before validating TLS certificates, we need to create an Issuer resource that will perform that task and generate the secrets for the certificates. We can create an <strong>Issuer</strong> or a <strong>ClusterIssuer</strong> resource just like we would in Kubernetes. This resource is pretty much the same for kubernetes and Helm, so we will just use the Chart Name for templating.</p>\n<details>\n<summary> <b>Show Template</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> if eq .Values.node_env \"production\" <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Issuer\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>letsencrypt\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">acme</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">privateKeySecretRef</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>letsencrypt\n    <span class=\"token key atrule\">server</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//acme<span class=\"token punctuation\">-</span>v02.api.letsencrypt.org/directory\n    <span class=\"token key atrule\">solvers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http01</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">ingress</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">class</span><span class=\"token punctuation\">:</span> contour\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> end <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n</div></details>\n<blockquote>\n<p>This issuer is the same we are using in the <strong>Kubernetes post</strong>, note that we have added the conditional clause wrapping the whole template. Thus, when the condition isn't met <strong>the manifest is blank and Helm will ignore it</strong>.</p>\n</blockquote>\n<h3 id=\"tls-certificates\" style=\"position:relative;\"><a href=\"#tls-certificates\" aria-label=\"tls certificates permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TLS certificates</h3>\n<p>Certificates will be issued by the <strong>Issuer</strong> and stored in a secret consumed by the <strong>HTTPProxy</strong> resource. For this example, we are specifying only one DNS Name, but thanks to Helm we could define an array and dynamically generate the manifest for each one of them.</p>\n<details>\n<summary> <b>Show Template</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> if eq .Values.node_env \"production\" <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Certificate\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>certs\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">dnsNames</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.domain <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">issuerRef</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>letsencrypt\n    <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Issuer\n  <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>certs\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> end <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n</div></details>\n<blockquote>\n<p><strong>NOTE:</strong> Certificates take a while to be issued, it is possible that <strong>HTTPProxy</strong> is created before the certificate is ready. This will cause the <strong>HTTPProxy</strong> service to fail. Check the status of the certs by running <code class=\"language-text\">kubectl describe Certificate &lt;cert-resource-name></code> and restart the HTTPProxy when they are ready.</p>\n</blockquote>\n<h3 id=\"httpproxy\" style=\"position:relative;\"><a href=\"#httpproxy\" aria-label=\"httpproxy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Httpproxy</h3>\n<p>Finally, we will create the <strong>HTTPProxy</strong> resource that will redirect to the corresponding pods depending on the specified <strong>fqdn</strong>. We template it so the <code class=\"language-text\">tls.secretName</code> and the <code class=\"language-text\">services</code> match their corresponding resource names.</p>\n<details>\n<summary> <b>Show Template</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> if eq .Values.node_env \"production\" <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> projectcontour.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> HTTPProxy\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>httpproxy\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">virtualhost</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">fqdn</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.domain <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">-</span>certs\n  <span class=\"token key atrule\">routes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">loadBalancerPolicy</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">strategy</span><span class=\"token punctuation\">:</span> Cookie\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> end<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n</div></details>\n<h2 id=\"conclusions\" style=\"position:relative;\"><a href=\"#conclusions\" aria-label=\"conclusions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusions</h2>\n<p>If you have been comparing this post with the <a href=\"/simple-app-kubernetes\">Kubernetes guide</a> you should have noticed that templating the resources is way easier since Helm does a great part of the job for us. Templates and dependencies are one of the biggest strengths of Helm, and makes of it a great tool for deploying complex applications. </p>\n<p>Besides all that have been shown in this guide, charts can be uploaded to the Artifact Hub using GitHub Pages and creating an account (a future post will cover this), and many other features of Helm remain to be discovered. So, if you already knew kubernetes and want to take a step further, Helm is the way to go.</p>"},{"id":"7a7ef764-81c5-58bc-b8a7-1cb102360543","headings":[{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2}],"frontmatter":{"title":"Deploying a simple NodeJS App in kubernetes","path":"/simple-app-kubernetes","tags":["Guide","Mid-level","Kubernetes"],"excerpt":"Steps on how to deploy simple NodeJS app, connected to a MongoDB host and exposing its endpoints through a Kubernetes service.","created":"2022-02-13T04:10:00.000Z","createdPretty":"13 February, 2022","updated":"2022-02-13T00:00:00.000Z","updatedPretty":"13 February, 2022","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfUlEQVQoz2PI3u+OibL2uyXutm48kTT/akfyHtuMfc45+z0wlTGg8YGKMve5tJ3OWH172q5Hq44937np3vyZlxvyDngBTcSl2SP3gGfuAa+8gz5pex17zxaee3Vw+qW6pdf7N96Zt/PhytQ99kApoAKgsmyYKxjAfC8gK32vE1BF6l77hF2Wq29NW3Vr2rmXhx59urP67rSdD1aUHQkBeiRljz1QGVAxRBdDyh47oFDBQb/Gk8nTLtVsuDvvyttT3359/ff33////798+3Tp/OV///7d/3h924MlQPc3nUwpOOgL1mXHsO3+kktvTjz/8vDHn2//weDXr19TJ02fu276gnNTZsycWVRU1Nnd+fzZc5Dcv/8///x4/vXhxddHgWHB8B8J/P33Byj/7fvXG9dvnr12eu2FZSs2Ltu3b//uvbu+/fj27/9fiAK4egYgH4yArkSIQtgvP768+eL6f3QAVPoXoovhPzbwFwj+/f3z9/fvP7+BHgbysCoDAEnUiX1fWTlwAAAAAElFTkSuQmCC","aspectRatio":2.1186440677966103,"src":"/static/6377120ee106e93bf8074fa36b79a901/0853f/cover.png","srcSet":"/static/6377120ee106e93bf8074fa36b79a901/14156/cover.png 125w,\n/static/6377120ee106e93bf8074fa36b79a901/d6e47/cover.png 250w,\n/static/6377120ee106e93bf8074fa36b79a901/0853f/cover.png 500w,\n/static/6377120ee106e93bf8074fa36b79a901/ce627/cover.png 750w,\n/static/6377120ee106e93bf8074fa36b79a901/9dbcf/cover.png 1000w,\n/static/6377120ee106e93bf8074fa36b79a901/3e265/cover.png 2800w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<style>\n    summary {\n        cursor: pointer;\n    }\n</style>\n<blockquote>\n<p><strong>NOTE</strong>: This guide will assume you have a basic understanding of Kubernetes and know how to run and manage a cluster. If you haven't already read my post about <a href=\"/kubernetes-fundamentals\">Kubernetes fundamentals</a>, I encourage you to read it first.</p>\n<p>All the code in this guide is available on <a href=\"https://github.com/alesancor1/Blog-Projects/tree/main/guides/simple-app-kubernetes\">GitHub</a></p>\n</blockquote>\n<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>For this guide, we will be deploying the simple NodeJS we build in a previous post, feel free to go <a href=\"/create-simple-app\">check it out</a> first. We will go through all the steps to set up our simple NodeJS app inside a Kubernetes cluster.</p>\n<blockquote>\n<p>This guide is parallel to the <a href=\"/simple-app-helm\">Creating a Helm Chart for a simple NodeJS App</a> guide, so you can open both posts and compare them, since both posts will follow the same exact structure.</p>\n</blockquote>\n<h2 id=\"creating-the-database-manifests\" style=\"position:relative;\"><a href=\"#creating-the-database-manifests\" aria-label=\"creating the database manifests permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the Database manifests</h2>\n<p>We will first write the database manifests files, starting by the service and then the pvc and finally the deployment. This order will be the same for the creation of the resources, since deployment depends on the pvc and the service needs to exist in order for the pods to be exposed by it.</p>\n<h3 id=\"service\" style=\"position:relative;\"><a href=\"#service\" aria-label=\"service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Service</h3>\n<p>Since we are deploying a MongoDB, we will set the service to use the default MongoDB port: <code class=\"language-text\">27017</code>. This way, our manifest will have the same port and target port:</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># svc.yaml</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'27017'</span>\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">27017</span>\n      <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">27017</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db</code></pre></div>\n</div></details>\n<blockquote>\n<p>This service will not be exposed to the outside world, all database connections will be managed internally through the <strong>kubernetes built-in DNS</strong>.</p>\n</blockquote>\n<h3 id=\"persistent-volume-claim\" style=\"position:relative;\"><a href=\"#persistent-volume-claim\" aria-label=\"persistent volume claim permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Persistent Volume Claim</h3>\n<p>For persistence, we will declare a <strong>PVC</strong> that claims a volume with 20Gi storage and <em>ReadWriteOnce</em> access mode:</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># pvc.yaml</span>\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> PersistentVolumeClaim\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ReadWriteOnce\n  <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 20Gi</code></pre></div>\n</div></details>\n<blockquote>\n<p>We will not create a persistent volume that matches this PVC, as mentioned in the <strong>Kubernetes Fundamentals</strong> post, we are letting de cluster <strong>dynamically provision</strong> the volume for us.</p>\n</blockquote>\n<h3 id=\"deployment\" style=\"position:relative;\"><a href=\"#deployment\" aria-label=\"deployment permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment</h3>\n<p>Once the service and PVC are created, we will now write the deployment manifest. The deployment will have the label <code class=\"language-text\">app</code> to be matched by the service <strong>selector</strong>, and will mount a volume to the <code class=\"language-text\">/data/db</code> container directory. This volume will reference our <strong>PVC</strong>:</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># deployment.yaml</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mongo\n          <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> Always\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">27017</span>\n              <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /data/db\n              <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> volume<span class=\"token punctuation\">-</span>simple<span class=\"token punctuation\">-</span>db<span class=\"token punctuation\">-</span>data\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> volume<span class=\"token punctuation\">-</span>simple<span class=\"token punctuation\">-</span>db<span class=\"token punctuation\">-</span>data\n          <span class=\"token key atrule\">persistentVolumeClaim</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">claimName</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db</code></pre></div>\n</div></details>\n<h2 id=\"creating-the-app-manifests\" style=\"position:relative;\"><a href=\"#creating-the-app-manifests\" aria-label=\"creating the app manifests permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the App manifests</h2>\n<h3 id=\"service-1\" style=\"position:relative;\"><a href=\"#service-1\" aria-label=\"service 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Service</h3>\n<p>The deployment will be made for both <strong>local</strong> and <strong>production</strong> environments, so we will need to write a service that binds the ports of the cluster to our <strong>local machine</strong> ports.</p>\n<p>Starting with the local service, we define it as a NodePort, which port and nodePort will be the same in which the app is running inside the container: <code class=\"language-text\">3300</code>.</p>\n<blockquote>\n<p><strong>NOTE</strong>: Since the port <code class=\"language-text\">3300</code> is not inside the default <strong>NodePort range</strong>, we will need to add the <code class=\"language-text\">--node-port-range</code> flag to the kubeapi-server.yml file. As described in the <strong>Kubernetes Fundamentals</strong> post.</p>\n</blockquote>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># svc-local.yaml</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n      <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app</code></pre></div>\n</div></details>\n<p>On the other hand, the production service will be set as <strong>ClusterIP</strong> (default) and exposed internally at port <code class=\"language-text\">3300</code> too:</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># svc.yaml</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n      <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app</code></pre></div>\n</div></details>\n<blockquote>\n<p>The service port can actually be any, we will be using the same port for both environments.</p>\n</blockquote>\n<h3 id=\"deployment-1\" style=\"position:relative;\"><a href=\"#deployment-1\" aria-label=\"deployment 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment</h3>\n<p>Our app will run on the port <code class=\"language-text\">3300</code> of the container. For that, we need to specify that port under the <code class=\"language-text\">containerPort</code> field, apart from passing the <code class=\"language-text\">PORT</code> environment variable to the container. We also have to make sure the labels specified in metadata are the same as the service selector.</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># deployment.yaml</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> PORT\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3300\"</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> DB_HOST\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> DB_PORT\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"27017\"</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> DB_NAME\n            <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> alesancor1/simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">:</span>latest\n          <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> Always\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n          <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n              <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n          <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 300Mi\n            <span class=\"token key atrule\">limits</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 500Mi</code></pre></div>\n</div></details>\n<blockquote>\n<p>Note that the <code class=\"language-text\">DB_HOST</code> env variable is set the same as the name of the MongoDB service. This is because the cluster automatically provides service discovery through its <strong>internal DNS</strong>.</p>\n</blockquote>\n<h2 id=\"running-locally-on-a-single-node-cluster\" style=\"position:relative;\"><a href=\"#running-locally-on-a-single-node-cluster\" aria-label=\"running locally on a single node cluster permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running locally on a single node cluster</h2>\n<p>With all the manifests files created, we can now deploy the app to the cluster. We will start a single node cluster (<strong>Minikube</strong> or <strong>Docker k8s</strong>) and apply the manifests in the same order as this guide does. For that, use the <code class=\"language-text\">-f</code> flag to specify the manifests files to be applied. Don't forget to create the namespace before applying the manifests.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl create namespace simple-app\n$ kubectl apply -f &lt;file></code></pre></div>\n<p>If you performed all the steps correctly (remember to run only local services manifests), you should be able to see the app running on <a href=\"http://localhost:3300\">http://localhost:3300</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d1f7d5ac4acebcb58c6854f4307e19ce/78363/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAc0lEQVQI1z2Kyw6CMBBF+VQlulAatOKGRXEhn6ppk05naPmAS7UNi5Oc+2ge0wxtZvTjC6fbE4frHcdOV7IrvedW1W73ks/9ADVOuJg3Gvv5QkQQF4GzFs5ZBKI/nPltzAwJITvX7wLyHkQeKca8l25NCRuLMHk2k5JCvgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"result\"\n        src=\"/static/d1f7d5ac4acebcb58c6854f4307e19ce/c1b63/result.png\"\n        srcset=\"/static/d1f7d5ac4acebcb58c6854f4307e19ce/5a46d/result.png 300w,\n/static/d1f7d5ac4acebcb58c6854f4307e19ce/0a47e/result.png 600w,\n/static/d1f7d5ac4acebcb58c6854f4307e19ce/c1b63/result.png 1200w,\n/static/d1f7d5ac4acebcb58c6854f4307e19ce/78363/result.png 1522w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"production-environments-dns-and-tls-configuration\" style=\"position:relative;\"><a href=\"#production-environments-dns-and-tls-configuration\" aria-label=\"production environments dns and tls configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Production environments: DNS and TLS configuration</h2>\n<p>For production environments, we will configure a DNS record pointing to the service. We will also configure a TLS certificate and a certificate signing request. For doing that, we will use <strong>Project Contour</strong> and <strong>Cert-Manager</strong> APIs, which simplifies the process. Since they are not native, first thing we need to do is installing them by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$    kubectl apply -f https://projectcontour.io/quickstart/contour.yaml\n$    kubectl apply -f https://github.com/jetstack/cert-manager/releases/download/v1.1.0/cert-manager.yaml</code></pre></div>\n<blockquote>\n<p><strong>Project Contour</strong> provide a Load Balancer service that will be our reverse proxy. Be sure to obtain its <strong>external IP</strong> and configure an <strong>A record</strong> in your <strong>NS zone</strong> pointing to that IP. The External IP can be obtained running <code class=\"language-text\">kubectl get -n projectcontour service envoy</code> (it takes a while to be ready).</p>\n<p>Be sure to apply the local services manifests when deploying to production</p>\n</blockquote>\n<h3 id=\"issuer-and-clusterissuer\" style=\"position:relative;\"><a href=\"#issuer-and-clusterissuer\" aria-label=\"issuer and clusterissuer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Issuer and ClusterIssuer</h3>\n<p>Before validating TLS certificates, we need to create an Issuer resource that will perform that task and generate the secrets for the certificates. We can create an <strong>Issuer</strong> or a <strong>ClusterIssuer</strong> resource. They are the same, except that the <strong>ClusterIssuer</strong> is not namespace and thus can be used in any namespace. We will use an <strong>Issuer</strong> resource under our <code class=\"language-text\">simple-app</code> namespace.</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Issuer\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>letsencrypt\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">acme</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">privateKeySecretRef</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>letsencrypt\n    <span class=\"token key atrule\">server</span><span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span>//acme<span class=\"token punctuation\">-</span>v02.api.letsencrypt.org/directory\n    <span class=\"token key atrule\">solvers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http01</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">ingress</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">class</span><span class=\"token punctuation\">:</span> contour</code></pre></div>\n</div></details>\n<blockquote>\n<p>This issuer uses the <strong>Let's Encrypt</strong> ACME server, there are ways to provide locally stored certs, check the <a href=\"https://cert-manager.io/docs/concepts/issuer/\">official documentation</a> for more information.</p>\n</blockquote>\n<h3 id=\"tls-certificates\" style=\"position:relative;\"><a href=\"#tls-certificates\" aria-label=\"tls certificates permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TLS certificates</h3>\n<p>For TLS certificates, we will use the <code class=\"language-text\">cert-manager</code> API. We will create a certificate object which will be issued by an Issuer. The validation process (<strong>HTTP-01 Challenge</strong>) will generate a secret that will be used by <strong>Httpproxy</strong> to redirect the trafic over TLS.</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> cert<span class=\"token punctuation\">-</span>manager.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Certificate\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>certs\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">dnsNames</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> simple<span class=\"token punctuation\">-</span>app.example.com\n  <span class=\"token key atrule\">issuerRef</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>letsencrypt\n    <span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Issuer\n  <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>certs</code></pre></div>\n</div></details>\n<blockquote>\n<p><strong>NOTE</strong>: You may need to restart Httproxy after validating certificates if you issued the certifiactes after creating the Httpproxy.</p>\n</blockquote>\n<h3 id=\"httpproxy\" style=\"position:relative;\"><a href=\"#httpproxy\" aria-label=\"httpproxy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Httpproxy</h3>\n<p>Once project contour is ready, we can create a HTTP proxy service that will be used to redirect all traffic to the project contour service using our previously configured DNS record.</p>\n<details>\n<summary> <b>Show Manifest</b> </summary><div style=\"margin-left:20px\">\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> projectcontour.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> HTTPProxy\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>httpproxy\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">virtualhost</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">fqdn</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app.example.com\n    <span class=\"token key atrule\">tls</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>certs\n  <span class=\"token key atrule\">routes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3300</span>\n    <span class=\"token key atrule\">loadBalancerPolicy</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">strategy</span><span class=\"token punctuation\">:</span> Cookie</code></pre></div>\n</div></details>\n<blockquote>\n<p>Note our simple-app is never running on port '80' as it is typical from web applications. We should avoid deploying our apps to container ports under 1024 since they would run as <strong>privileged</strong> user, causing a potential security issue.</p>\n</blockquote>\n<h2 id=\"conclusions\" style=\"position:relative;\"><a href=\"#conclusions\" aria-label=\"conclusions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusions</h2>\n<p>As you may have noticed, deploying an application to production is a bit more harder than doing it locally. Certificates and DNS makes the process a little more complicated, but luckily we count with the help of <strong>Project Contour</strong> and <strong>Cert-Manager</strong>. Still, the process is not so straight forward and depends a lot on configuration and knowledge of the underlying technologies, such as DNS records and networking.</p>"},{"id":"3271eee8-818e-522d-9a7b-98d2a313402d","headings":[{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":4},{"depth":2}],"frontmatter":{"title":"Helm fundamentals: The package manager for Kubernetes","path":"/helm-fundamentals","tags":["Technologies","Mid-level","Helm","Kubernetes"],"excerpt":"Discovering the basics of Helm: Templating kubernetes manifests and deploying charts","created":"2022-02-13T00:00:00.000Z","createdPretty":"13 February, 2022","updated":"2022-02-13T00:00:00.000Z","updatedPretty":"13 February, 2022","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZElEQVQoz62TsUvDQBTG86/pJiKC4D+gIA46d5AqiuIoCuogSHGRDg4urbSIVKsoVqXUtKi12qVNSZtgTBNtc/m8trlwSRtx8MHjhS/3fvdd8k7AH8O2bbey5HUWQtDiQU2EVov0dFb5Phfoh/JakJOgPo9Di5BuVT8NmK22CySk915rEuzFNUxvyIgkNOgmCXbImsRyDcmHF5zcPbsbdKJt2ZiioPFlCauHKsaWJMxuyX1OBd7BI4Xtxm5wIb7jqlDG8bWIutamSZAvf2MoVEHy3sB5zkTstonhUBXFSstjqAd06CVJwX4ig3jmicLySItvXaCiE8QpYHRRwlFax6VoIprSMRKWcJY1nM/lP7IDfa02cJotIpUruRpzMLMpY3KthvWoiomVGua26/1H9oyFs8sX/SH8QrZ7Q7OwEFEwv1NH+EDBR5N4+jxAftb8Gq/7gwwam6DbMOi545blr4P9X/EDsT+Wli9wDpkAAAAASUVORK5CYII=","aspectRatio":1.6025641025641026,"src":"/static/5172fa989e47bcfc4ceced2b21c84bd0/0853f/cover.png","srcSet":"/static/5172fa989e47bcfc4ceced2b21c84bd0/14156/cover.png 125w,\n/static/5172fa989e47bcfc4ceced2b21c84bd0/d6e47/cover.png 250w,\n/static/5172fa989e47bcfc4ceced2b21c84bd0/0853f/cover.png 500w,\n/static/5172fa989e47bcfc4ceced2b21c84bd0/52190/cover.png 727w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<style>\n    table {\n        border-collapse: collapse;\n        width: 100%;\n    }\n    td, th {\n        border: 1px solid #dddddd;\n        padding: 8px;\n    }\n    th {\n        text-align: center;\n        background-color: #dddddd;\n    }\n    tr:nth-child(even) {\n        background-color: #ffffff;\n    }\n    tr:nth-child(odd) {\n        background-color: #efefef;\n    }\n    summary {\n        cursor: pointer;\n    }\n</style>\n<blockquote>\n<p><strong>NOTE:</strong> This post is about the Helm package manager for Kubernetes, if you don't know about Kubernetes, please read the <a href=\"/kubernetes-fundamentals\">Kubernetes fundamentals</a> post first.</p>\n</blockquote>\n<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>Helm is the package manager for kubernetes. Just like npm to node, Helm provides an easy way to install and manage software deployments inside a Kubernetes cluster. Helm is template-based, meaning that it can be used to deploy any kind of software, from microservices to complex applications.</p>\n<p>Helm main object is called <strong>Chart</strong>, consisting of a set of <strong>templates</strong>, which are used along side a set of default values to generate valid <strong>kubernetes manifests</strong>. Helm charts support dependencies, allowing to create child charts that can be used to create complex applications.</p>\n<blockquote>\n<p>Helm templates are written in a language result of combining the <strong>Go template language</strong>, some extra functions and a variety of wrappers to epose certain objects to templates. Many resources on <a href=\"https://pkg.go.dev/text/template\">Go templates docs</a> may be helpful when templating with Helm.</p>\n</blockquote>\n<h3 id=\"helm-charts\" style=\"position:relative;\"><a href=\"#helm-charts\" aria-label=\"helm charts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm Charts</h3>\n<p>A Chart is a collection of files that describe a related set of Kubernetes resources. A single chart might be used to deploy something simple, like a memcached pod, or something complex, like a full web app stack with HTTP servers, databases, caches, and so on. </p>\n<p>Charts are created as files laid out in a particular directory tree. They can be packaged into versioned archives to be deployed.</p>\n<h2 id=\"helm-cli\" style=\"position:relative;\"><a href=\"#helm-cli\" aria-label=\"helm cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm CLI</h2>\n<blockquote>\n<p>Helm provides a command line interface for managing our Helm installation. Below is a list of commands that can be used to interact with Helm, think of it as a quick reference cheat sheet. The complete documentation on Helm CLI can be found <a href=\"https://helm.sh/docs/helm/\">here</a>.</p>\n</blockquote>\n<h3 id=\"helm-create\" style=\"position:relative;\"><a href=\"#helm-create\" aria-label=\"helm create permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm create</h3>\n<p>Creates a new chart. Running this command will create a directory named after the chart name, containing the basic <a href=\"#chart-file-structure\">chart file structure</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ helm create my-chart</code></pre></div>\n<h3 id=\"helm-list\" style=\"position:relative;\"><a href=\"#helm-list\" aria-label=\"helm list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm list</h3>\n<p>List all of the releases for a specified namespace (uses current namespace context if not defined).</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ helm list [flags]</code></pre></div>\n<details>\n<summary>Commonly used flags</summary><div style=\"margin-left:20px; margin-top: 15px\">\n<table>\n<thead>\n<tr>\n<th><strong>Flag</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Exampe</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--all</td>\n<td align=\"center\">-a</td>\n<td>Show all releases without any filters</td>\n<td><code class=\"language-text\">helm list -a</code></td>\n</tr>\n<tr>\n<td>--short</td>\n<td align=\"center\">-q</td>\n<td>Short (quiet) format</td>\n<td><code class=\"language-text\">helm list -q</code></td>\n</tr>\n<tr>\n<td>--filter</td>\n<td align=\"center\"></td>\n<td>Filter by Perl-compatible regex</td>\n<td><code class=\"language-text\">helm list --filter 'ara[a-z]+'</code></td>\n</tr>\n</tbody>\n</table>\n</div></details>\n<h3 id=\"helm-dependency-list\" style=\"position:relative;\"><a href=\"#helm-dependency-list\" aria-label=\"helm dependency list permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm dependency list</h3>\n<p>List all of the dependencies for a specified chart.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ helm dependency list CHART [flags]</code></pre></div>\n<h3 id=\"helm-dependency-update\" style=\"position:relative;\"><a href=\"#helm-dependency-update\" aria-label=\"helm dependency update permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm dependency update</h3>\n<p>Update the dependencies for a specified chart.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ helm dependency update CHART [flags]</code></pre></div>\n<blockquote>\n<p><strong>NOTE:</strong> This command is commonly used as <code class=\"language-text\">helm dep up</code></p>\n</blockquote>\n<h3 id=\"helm-repo-add\" style=\"position:relative;\"><a href=\"#helm-repo-add\" aria-label=\"helm repo add permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm repo add</h3>\n<p>Adds a repository containing installable helm charts. When installing a chart, dependencies repositories is automatically added.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ helm repo add NAME URL [flags]</code></pre></div>\n<details>\n<summary>Commonly used flags</summary><div style=\"margin-left:20px; margin-top: 15px\">\n<table>\n<thead>\n<tr>\n<th><strong>Flag</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--allow-deprecated-repos</td>\n<td align=\"center\"></td>\n<td>Set to true to allow adding deprecated repos</td>\n</tr>\n<tr>\n<td>--username &#x3C;string></td>\n<td align=\"center\"></td>\n<td>Repository username</td>\n</tr>\n<tr>\n<td>--password &#x3C;string></td>\n<td align=\"center\"></td>\n<td>Repository password</td>\n</tr>\n<tr>\n<td>--password-stdin</td>\n<td align=\"center\"></td>\n<td>Prompts an input for the password</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p><strong>Warning</strong>: Always try to use --password-stdin flag iover --password flag to avoid your password being storaged in the shell history.</p>\n</blockquote>\n</div></details>\n<h3 id=\"helm-install\" style=\"position:relative;\"><a href=\"#helm-install\" aria-label=\"helm install permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Helm install</h3>\n<p>Installs a new chart. The install argument must be a chart reference, a path to a packaged chart, a path to an unpacked chart directory or a URL.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    $ helm install NAME CHART [flags]</code></pre></div>\n<p>There are five different ways you can express the chart you want to install:</p>\n<ul>\n<li><strong>By chart reference:</strong> <code class=\"language-text\">helm install mymaria example/mariadb</code></li>\n<li><strong>By path to a packaged chart:</strong> <code class=\"language-text\">helm install mynginx ./nginx-1.2.3.tgz</code></li>\n<li><strong>By path to an unpacked chart directory:</strong> <code class=\"language-text\">helm install mynginx ./nginx</code></li>\n<li><strong>By absolute URL:</strong> <code class=\"language-text\">helm install mynginx https://example.com/charts/nginx-1.2.3.tgz</code></li>\n<li><strong>By chart reference and repo url:</strong> <code class=\"language-text\">helm install --repo https://example.com/charts/ mynginx nginx</code></li>\n</ul>\n<details>\n<summary>Commonly used flags</summary><div style=\"margin-left:20px; margin-top: 15px\">\n<table>\n<thead>\n<tr>\n<th><strong>Flag</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Exampe</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--dependency-update</td>\n<td align=\"center\"></td>\n<td>Show all releases without any filters</td>\n<td><code class=\"language-text\">helm install example example --depency-update</code></td>\n</tr>\n<tr>\n<td>--dry-run</td>\n<td align=\"center\"></td>\n<td>simulate install</td>\n<td><code class=\"language-text\">helm install example example --dry-run</code></td>\n</tr>\n<tr>\n<td>--set</td>\n<td align=\"center\"></td>\n<td>set values from command line</td>\n<td><code class=\"language-text\">helm install example example --set key=val</code></td>\n</tr>\n<tr>\n<td>--values</td>\n<td align=\"center\">-f</td>\n<td>Specify user defined YAML values file</td>\n<td><code class=\"language-text\">helm install example example --f values.yml</code></td>\n</tr>\n</tbody>\n</table>\n</div></details>\n<h2 id=\"creating-charts\" style=\"position:relative;\"><a href=\"#creating-charts\" aria-label=\"creating charts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating Charts</h2>\n<p>For creating a Chart, we use the <code class=\"language-text\">helm create NAME</code> command. This command will generate the <strong>directory structure</strong> for a new chart.</p>\n<h3 id=\"chart-file-structure\" style=\"position:relative;\"><a href=\"#chart-file-structure\" aria-label=\"chart file structure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chart File Structure</h3>\n<p>A chart is organized as a collection of files inside of a directory. The directory name is the name of the chart (without versioning information). Thus, a chart describing WordPress would be stored in a wordpress/ directory.</p>\n<p>Inside of this directory, Helm will expect a structure that matches this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">wordpress/\nChart.yaml              # A YAML file containing information about the chart\nLICENSE                 # OPTIONAL: A plain text file containing the license for the chart\nREADME.md               # OPTIONAL: A human-readable README file\nvalues.yaml             # The default configuration values for this chart\nvalues.schema.json      # OPTIONAL: A JSON Schema for imposing a structure on the values.yaml file\ncharts/                 # A directory containing any charts upon which this chart depends.\ncrds/                   # Custom Resource Definitions\ntemplates/              # A directory of templates that, when combined with values,\n                        # will generate valid Kubernetes manifest files.\ntemplates/NOTES.txt     # OPTIONAL: A plain text file containing short usage notes</code></pre></div>\n<p>Helm reserves use of the charts/, crds/, and templates/ directories, and of the listed file names. Other files will be left as they are.</p>\n<h3 id=\"the-chartyaml-file\" style=\"position:relative;\"><a href=\"#the-chartyaml-file\" aria-label=\"the chartyaml file permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Chart.yaml file</h3>\n<p>The chart file is required for a chart. It contains metdadta about the chart, including the name, version, description, and other information. Since Helm v3, the Chart.yaml file also contains a list of the chart dependencies. </p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> The chart API version (required)\n<span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> The name of the chart (required)\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> A SemVer 2 version (required)\n<span class=\"token key atrule\">kubeVersion</span><span class=\"token punctuation\">:</span> A SemVer range of compatible Kubernetes versions (optional)\n<span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> A single<span class=\"token punctuation\">-</span>sentence description of this project (optional)\n<span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> The type of the chart (optional)\n<span class=\"token key atrule\">keywords</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> A list of keywords about this project (optional)\n<span class=\"token key atrule\">home</span><span class=\"token punctuation\">:</span> The URL of this projects home page (optional)\n<span class=\"token key atrule\">sources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> A list of URLs to source code for this project (optional)\n<span class=\"token key atrule\">dependencies</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># A list of the chart requirements (optional)</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> The name of the chart (nginx)\n    <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> The version of the chart (\"1.2.3\")\n    <span class=\"token key atrule\">repository</span><span class=\"token punctuation\">:</span> (optional) The repository URL (\"https<span class=\"token punctuation\">:</span>//example.com/charts\") or alias (\"@repo<span class=\"token punctuation\">-</span>name\")\n    <span class=\"token key atrule\">condition</span><span class=\"token punctuation\">:</span> (optional) A yaml path that resolves to a boolean<span class=\"token punctuation\">,</span> used for enabling/disabling charts (e.g. subchart1.enabled )\n    <span class=\"token key atrule\">tags</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># (optional)</span>\n      <span class=\"token punctuation\">-</span> Tags can be used to group charts for enabling/disabling together\n    <span class=\"token key atrule\">import-values</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># (optional)</span>\n      <span class=\"token punctuation\">-</span> ImportValues holds the mapping of source values to parent key to be imported. Each item can be a string or pair of child/parent sublist items.\n    <span class=\"token key atrule\">alias</span><span class=\"token punctuation\">:</span> (optional) Alias to be used for the chart. Useful when you have to add the same chart multiple times\n<span class=\"token key atrule\">maintainers</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># (optional)</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> The maintainers name (required for each maintainer)\n    <span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span> The maintainers email (optional for each maintainer)\n    <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> A URL for the maintainer (optional for each maintainer)\n<span class=\"token key atrule\">icon</span><span class=\"token punctuation\">:</span> A URL to an SVG or PNG image to be used as an icon (optional).\n<span class=\"token key atrule\">appVersion</span><span class=\"token punctuation\">:</span> The version of the app that this contains (optional). Needn't be SemVer. Quotes recommended.\n<span class=\"token key atrule\">deprecated</span><span class=\"token punctuation\">:</span> Whether this chart is deprecated (optional<span class=\"token punctuation\">,</span> boolean)\n<span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">example</span><span class=\"token punctuation\">:</span> A list of annotations keyed by name (optional).</code></pre></div>\n<h3 id=\"templating\" style=\"position:relative;\"><a href=\"#templating\" aria-label=\"templating permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Templating</h3>\n<p>When it comes to templates, Helm will use the <code class=\"language-text\">{{}}</code> syntax to substitute values into the template. Everything we need to do is take <strong>kubernetes manifests</strong> and substitute values into them. Defaults values will be written to the values.yaml file, and users will be able to override them through their own values.yaml file or command line flags.</p>\n<p>Helm provides <strong>flow control</strong> support and some <strong>Built-in Objects</strong> that makes templating generic manifests easier. Since charts can be installed multiple times with different values, we should try to make manifests as generic as possible, and use values to control the behavior of the chart.</p>\n<h4 id=\"built-in-objects\" style=\"position:relative;\"><a href=\"#built-in-objects\" aria-label=\"built in objects permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Built-in Objects</h4>\n<p>The following built-in objects are available for use in templates:</p>\n<ul>\n<li>\n<p><strong>Release</strong>: Describes the release itself, contains the following fields:</p>\n<ul>\n<li><em>Release.Name</em>: The release name</li>\n<li><em>Release.Namespace</em>: The namespace to be released into (if the manifest doesnt override)</li>\n<li><em>Release.IsUpgrade</em>: This is set to true if the current operation is an upgrade or rollback.</li>\n<li><em>Release.IsInstall</em>: This is set to true if the current operation is an install.</li>\n<li><em>Release.Revision</em>: The revision number for this release.It is incremented with each upgrade and rollback.</li>\n<li><em>Release.Service</em>: The service that is rendering the present template. On Helm, this is always Helm.</li>\n</ul>\n</li>\n<li><strong>Values</strong>: Values passed into the template from the <em>values.yaml</em> file and from user-supplied files. By default, Values is empty.</li>\n<li><strong>Chart</strong>: The contents of the <em>Chart.yaml</em> file. All data is accessible through the <code class=\"language-text\">{{ .Chart.&lt;Field> }}</code> syntax.</li>\n<li>\n<p><strong>Template</strong>: Contains information about the current template that is being executed</p>\n<ul>\n<li><em>Template.Name</em>: A namespaced file path to the current template <em>(e.g. mychart/templates/mytemplate.yaml)</em></li>\n<li><em>Template.BasePath</em>: The namespaced path to the templates directory of the current chart <em>(e.g. mychart/templates)</em></li>\n</ul>\n</li>\n</ul>\n<p>These are the most common objects, there are other ones like <strong>Files</strong> for access non-special files, or <strong>Capabilities</strong>, which provides information about the capabilities of the Kubernetes cluster.</p>\n<p>Below is an example of a template that uses the <code class=\"language-text\">{{ .Values.key }}</code> syntax to create a service manifest by accessing the values in the Values object, appart from Built-in Objects and conditionals.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Release.Namespace <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> if eq .Values.node_env \"development\" <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort\n  <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> end <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> if eq .Values.node_env \"development\" <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Values.port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">-</span> end <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> .Chart.Name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>Helm simplifies the creation of kubernetes manifests a lot. It may be a little confusing at the start because of Go Template syntax, but once you get used to it, templating complex manifests becomes really easy. Flow control and Dependency support brings on the capacity of generating one template for many different manifests. Besides, Helm automatically installs Kubernetes resources in order, so you don't need to worry about installing a resource before installing another one.</p>\n<blockquote>\n<p><strong>Tip</strong>: Charts are usually uploaded to <a href=\"https://artifacthub.io/\">Artifact Hub</a>, take a look at some of the most rated charts on the site.</p>\n</blockquote>"},{"id":"0c4244e2-659c-5c66-aae6-4b1c381ca67a","headings":[{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3}],"frontmatter":{"title":"Kubernetes fundamentals","path":"/kubernetes-fundamentals","tags":["Technologies","Mid-level","Kubernetes"],"excerpt":"A really brief introduction on the basics of Kubernetes: CLI commands, commonly used resources and basic cluster administration.","created":"2022-02-12T00:00:00.000Z","createdPretty":"12 February, 2022","updated":"2022-02-12T00:00:00.000Z","updatedPretty":"12 February, 2022","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABLElEQVQ4y52TMU/CQBiG+Xsm6uTq4A9gYvIXEGVw0IQ4MZhodDAYEsLg4KJIlBBM1ESiosECBRHplZbz7l5b9JqjtlB8ky/57vLd0/e9tjH4JIRb4rcX4FyAOaXuyT5Isb/ASZgquZ4GDQSqB+4bI2SvCEyb/0CVB0YGykO7p30sbWpY3WlhZauJOwfuivF/RB4MOZZTGg7OB6jWbcQzOpLZngeM7FC6e2zTsbvDCwPFBwvr+10k9jrezEygency0nbhAwvJN6ylW1jc0LzI6suJHFnq7HaI45KBJ8fxtLlQh66edYp6h+Lm1UaPMPRNhsb7F2pNihdn36IRHKrAy5qFfIXgqGjg5JqM125fqJrIlQn0TzZx33NFDtNckeW3GFT+uXCg77ebVWHAb2YQ8UBD6SDnAAAAAElFTkSuQmCC","aspectRatio":1.5625,"src":"/static/d89e9f6ff66e551655fa3708287cad65/0853f/cover.png","srcSet":"/static/d89e9f6ff66e551655fa3708287cad65/14156/cover.png 125w,\n/static/d89e9f6ff66e551655fa3708287cad65/d6e47/cover.png 250w,\n/static/d89e9f6ff66e551655fa3708287cad65/0853f/cover.png 500w,\n/static/d89e9f6ff66e551655fa3708287cad65/ce627/cover.png 750w,\n/static/d89e9f6ff66e551655fa3708287cad65/21a00/cover.png 927w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<style>\n    table {\n        border-collapse: collapse;\n        width: 100%;\n    }\n    td, th {\n        border: 1px solid #dddddd;\n        padding: 8px;\n    }\n    th {\n        text-align: center;\n        background-color: #dddddd;\n    }\n    tr:nth-child(even) {\n        background-color: #ffffff;\n    }\n    tr:nth-child(odd) {\n        background-color: #efefef;\n    }\n    summary {\n        cursor: pointer;\n    }\n</style>\n<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>Kubernetes (commonly abbreviated as k8s) is a <strong>container orchestration</strong> system that is designed to be easy to use and easy to deploy. As the \"container orchestation\" term suggests, Kubernetes relies on containers and offers an administration environment that focus on them. According to their docs:</p>\n<blockquote>\n<p>Kubernetes is a portable and extensible open source platform for managing workloads and services. Kubernetes facilitates automation and declarative configuration. It has a large and rapidly growing ecosystem. Support, tools and services for Kubernetes are widely available.</p>\n</blockquote>\n<p>Summing up, kubernetes offers a fully equiped administration environment for running multiple containers, which makes it the favourite choice when it comes to deploying microservices inside a <strong>cluster</strong>.</p>\n<h3 id=\"clusters\" style=\"position:relative;\"><a href=\"#clusters\" aria-label=\"clusters permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Clusters</h3>\n<p>A Cluster is a set of <strong>nodes</strong> that run containerized applications. Kubernetes clusters allow containers to run across multiple machines and environments: virtual, physical, cloud-based, and on-premises. Kubernetes containers are not restricted to a specific operating system, unlike virtual machines. Instead, they are able to share operating systems and run anywhere.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 479px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/924c59ad7cfb1c94e8f4802c3a76ef0b/a9b70/cluster.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQ0lEQVQ4y42U247TMBRF+/9fAO88wDcgJBBCAiR4qYaZ3pKmTaaTtLnZdeJbstkNdBpmisDtkV3FXdnnnG1PwNH3/WOch+k6uO7y+3EPP8N3tHc8Js9AvsO+ddgqg6Q1qLyDxxXw6H/j9QS/N2vXY68c1oVFmDuE0mAlNWalRtholJ2D+4uq8csmp4VoOmxOoL1FUGgsaoVt4ZBKqvM9YkKnlcCylRBawzmHXXbAfbq/phBIa4+IwIe8w5cqx8uHOb7dKcxixaceDVOf5hJzLZHpBs46FHxBuL1HFO+wZpzhE8/CJyVrVtoh3SC1eP1B4t1U49Unia/LFgmVBlS27jSy3l5Nt2MTB2Bre2zzE9AhFhbLg8H7oMGLVYTvDxKfYyqTR6zaIxaMtVEwTFk1LUqqzMsa2phLDYf6HQgjcFNZpI3DXBi8Sba4TRVuyyObQpg6ASUWTFs57styzIKIwArO+wtwz/qdgIPC2mIaM9WPgrPDj5wdVi3ClsHahbbB0imInjUsKqyiBILqKyEfoReFlcMqs9AswSIxeHsjEDGtX8BmAAaGs2vQdh5tSyvVAlUth7Sd85cu50c/2CYg8Nz+THj60GDL+kSncFTrNY69/7cPT4tUUOHBDv7bUe2yNNg0BFFJZDQCq1HQ3NdOyx8+PC8cDXxPaMQIGTGP36blC+i50Bqkzj4z8bXzPBk/aGyH6CAR5axfIeg/xZNTI1ENBpeNLoX/uhw8OzVbrXEzDzhH2NH907slsn1+gTy5TJ6Onx4Dho/gkBDxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cluster\"\n        title=\"cluster\"\n        src=\"/static/924c59ad7cfb1c94e8f4802c3a76ef0b/a9b70/cluster.png\"\n        srcset=\"/static/924c59ad7cfb1c94e8f4802c3a76ef0b/5a46d/cluster.png 300w,\n/static/924c59ad7cfb1c94e8f4802c3a76ef0b/a9b70/cluster.png 479w\"\n        sizes=\"(max-width: 479px) 100vw, 479px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Clusters consists on a <strong>master node</strong> and a number of <strong>worker nodes</strong>. Nodes are independent machines with a number of cores and memory each which can run multiple containers. The master node controls the state of the cluster and is the origin of all task assignments, coordinating processses such as scheduling and scaling applications, maintaining the cluster state or implementeing updates.</p>\n<p>Worker nodes, on the other hand, are the nodes that perform the master's assignments. They operate as part of one system, orchestated by the master. Worker noeds can be virtual or physical machines.</p>\n<h3 id=\"single-node-clusters\" style=\"position:relative;\"><a href=\"#single-node-clusters\" aria-label=\"single node clusters permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Single Node Clusters</h3>\n<p>Single node clusters are a popular solution for testing and development purposes. Since they consists on a single node, they are able to run in local machines where developers can work on their applications' development.</p>\n<p>Most used single node clusters are <a href=\"https://minikube.sigs.k8s.io/docs/start/\">Minikube</a> and <a href=\"https://docs.docker.com/desktop/kubernetes/\">Docker Kubernetes</a>. The last one comes installed with Docker Desktop so you only need to activate kubernetes from the settings.</p>\n<h3 id=\"kubernetes-cluster-structure\" style=\"position:relative;\"><a href=\"#kubernetes-cluster-structure\" aria-label=\"kubernetes cluster structure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kubernetes Cluster Structure</h3>\n<p>A Kubernetes cluster contains six main components:</p>\n<ol>\n<li><strong>API server:</strong> Exposes a REST interface to all Kubernetes resources. Serves as the front end of the Kubernetes control plane.</li>\n<li><strong>Scheduler:</strong> Places containers according to resource requirements and metrics. Makes note of Pods with no assigned node, and selects nodes for them to run on.</li>\n<li><strong>Controller manager:</strong> Runs controller processes and reconciles the clusters actual state with its desired specifications. Manages controllers such as node controllers, endpoints controllers and replication controllers.</li>\n<li><strong>Kubelet:</strong> Ensures that containers are running in a Pod by interacting with the Docker engine , the default program for creating and managing containers. Takes a set of provided PodSpecs and ensures that their corresponding containers are fully operational.</li>\n<li><strong>Kube-proxy:</strong> Manages network connectivity and maintains network rules across nodes. Implements the Kubernetes Service concept across every node in a given cluster.</li>\n<li><strong>Etcd:</strong> Stores all cluster data. Consistent and highly available Kubernetes backing store. </li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1cff3242811833ad24a683ff19209921/3c492/cluster-components.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABs0lEQVQoz4WSbY+aQBDH+f4fpknTNNe0sQ+ePSuKioA8uAIq4Mozu7C7qHgduNyLvuo/EzI77G9mMrOS4JyQKn4XvuA8zzlj9/v99X+S8qI0kbtQdc1ybOQuta1q2IcgbNsW+NtgIDgSSsF5PF7frIdxnLxo1mi21PdHdAwma+O7vFIdt2GNAOJ67a29pmkWBGFZlv9UppSmWRZG58vQNjhxksClrusAq2hN6obWDTQIZYqyInUNwYpQyCjVIEojHK/M3Xxjmnu/KPIsyyAc4ctct8aLte7stZ07XqgG8lQbQUQxbFrX0sCSU4QXW2emWTry8qKAXmgPY3ljTpYawKqFxvM1wGvTmSgbgOu66eGKkCTPszRNkhhjnOV5NbQNv6Yr7cPTt7my1B3349ef48nU2vufRs9fRj84FxITHJ/P01/PrGncUzgznD+6bSD/0XVCCM20X2TF9Xzk+eOpbFr9In7Lir41GWcS4zw8HGafn2ByQXQ2kbdFnns8QWXGGKFECA6jdnbIPx6Q68I44BVAU5xzSXABOVjbwlV4MNdhOwAMK33c3wW5urcPbP4GdgP/LxwGIwgCI9vOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cluster\"\n        title=\"cluster\"\n        src=\"/static/1cff3242811833ad24a683ff19209921/c1b63/cluster-components.png\"\n        srcset=\"/static/1cff3242811833ad24a683ff19209921/5a46d/cluster-components.png 300w,\n/static/1cff3242811833ad24a683ff19209921/0a47e/cluster-components.png 600w,\n/static/1cff3242811833ad24a683ff19209921/c1b63/cluster-components.png 1200w,\n/static/1cff3242811833ad24a683ff19209921/3c492/cluster-components.png 1300w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>These six components can each run on Linux or as Docker containers (This is the case of Docker desktop kubernetes). The master node runs the <strong>Control Plane</strong> (API server, scheduler and controller manager), and the worker nodes run the kubelet and kube-proxy.</p>\n<blockquote>\n<p>kubernetes also provides an internal <strong>DNS server</strong> for registering services domain names, it is automatically included in the DNS requests made from the containers.</p>\n</blockquote>\n<h2 id=\"cli-commands\" style=\"position:relative;\"><a href=\"#cli-commands\" aria-label=\"cli commands permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CLI commands</h2>\n<blockquote>\n<p>This section does not cover the complete Kubernetes CLI documentation. Think of it as a quick reference cheat sheet for basic commands when managing your cluster. You can find the complete documentation <a href=\"https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands\">here</a>.</p>\n</blockquote>\n<h3 id=\"basic-commands\" style=\"position:relative;\"><a href=\"#basic-commands\" aria-label=\"basic commands permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic commands</h3>\n<ul>\n<li>\n<p><strong>Kubectl create</strong>:</p>\n<p>Create a resource from a file or from stdin.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl create RESOURCE NAME [...PROPERTIES]</code></pre></div>\n<blockquote>\n<p>You can run <code class=\"language-text\">kubectl api-resources</code> to see the different resources available. Check the <a href=\"#resources\">Resources</a> sections for more information</p>\n</blockquote>\n</li>\n<li>\n<p><strong>Kubectl get</strong></p>\n<p>Display one or many resources.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl get [(-o|--output=)json|yaml|name|go-template|go-template-file|template|templatefile|jsonpath|jsonpath-as-json|jsonpath-file|custom-columns-file|custom-columns|wide] (TYPE[.VERSION][.GROUP] [NAME | -l label] | TYPE[.VERSION][.GROUP]/NAME ...) [flags]</code></pre></div>\n<table>\n<thead>\n<tr>\n<th><strong>Option</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Exampe</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--namespace</td>\n<td align=\"center\">-n</td>\n<td>Specify the namespace to get resources from</td>\n<td><code class=\"language-text\">Kubectl get pods --namespace=example</code></td>\n</tr>\n<tr>\n<td>--output</td>\n<td align=\"center\">-o</td>\n<td>Output format</td>\n<td><code class=\"language-text\">Kubectl get deployments -o json</code></td>\n</tr>\n</tbody>\n</table>\n<br>\n</li>\n<li>\n<p><strong>Kubectl describe</strong></p>\n<p>Show details of a specific resource. Print a detailed description of the selected resources, including related resources such as events or controllers. You may select a single object by name, all objects of that type, provide a name prefix, or label selector.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl describe RESOURCE NAME</code></pre></div>\n<table>\n<thead>\n<tr>\n<th><strong>Option</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Exampe</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--namespace</td>\n<td align=\"center\">-n</td>\n<td>Specify the namespace to <br>get resources from</td>\n<td><code class=\"language-text\">Kubectl describe pods --namespace=example</code></td>\n</tr>\n</tbody>\n</table>\n<br>\n</li>\n<li>\n<p><strong>Kubectl delete</strong></p>\n<p>Delete resources by file names, stdin, resources and names, or by resources and label selector.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl delete ([-f FILENAME] | [-k DIRECTORY] | TYPE [(NAME | -l label | --all)])</code></pre></div>\n<table>\n<thead>\n<tr>\n<th><strong>Option</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Exampe</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--namespace</td>\n<td align=\"center\">-n</td>\n<td>Specify the namespace <br>to get resources from</td>\n<td><code class=\"language-text\">Kubectl delete pods example --namespace=example</code></td>\n</tr>\n<tr>\n<td>--force</td>\n<td align=\"center\"></td>\n<td>Forces the deletion of the resource</td>\n<td><code class=\"language-text\">Kubectl delete pods example --force</code></td>\n</tr>\n<tr>\n<td>--selector</td>\n<td align=\"center\">-l</td>\n<td>Label query to filter on</td>\n<td><code class=\"language-text\">Kubectl delete pods --l key=value</code></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>Deleting a namespace will also delete all objects in that namespace.</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"app-management\" style=\"position:relative;\"><a href=\"#app-management\" aria-label=\"app management permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>App management</h3>\n<ul>\n<li>\n<p><strong>Kubectl apply</strong></p>\n<p>Apply a configuration to a resource by file (manifest) name or stdin. The resource name must be specified. This resource will be created if it doesn't exist yet.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl apply (-f FILENAME | -k DIRECTORY)</code></pre></div>\n<blockquote>\n<p>Check the <a href=\"#manifests\">Manifests</a> section to see the structure of the files.</p>\n</blockquote>\n</li>\n<li>\n<p><strong>Kubectl scale</strong></p>\n<p>Set a new size for a deployment, replica set, replication controller, or stateful set.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl scale [--resource-version=version] [--current-replicas=count] --replicas=COUNT (-f FILENAME | TYPE NAME)</code></pre></div>\n</li>\n</ul>\n<h3 id=\"working-with-apps\" style=\"position:relative;\"><a href=\"#working-with-apps\" aria-label=\"working with apps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Working with apps</h3>\n<ul>\n<li>\n<p><strong>Kubectl exec</strong></p>\n<p>Execute a command in a container.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl exec (POD | TYPE/NAME) [-c CONTAINER] [flags] -- COMMAND [args...]</code></pre></div>\n<table>\n<thead>\n<tr>\n<th><strong>Option</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Exampe</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--container</td>\n<td align=\"center\">-c</td>\n<td>Container name</td>\n<td><code class=\"language-text\">kubectl exec example -c cname -- echo \"hi\"</code></td>\n</tr>\n<tr>\n<td>--stdin</td>\n<td align=\"center\">-i</td>\n<td>Pass stdin to the container</td>\n<td><code class=\"language-text\">Kubectl exec -i example -- echo \"hi\"</code></td>\n</tr>\n<tr>\n<td>--tty</td>\n<td align=\"center\">-l</td>\n<td>Stdin is a TTY</td>\n<td><code class=\"language-text\">Kubectl exec -t example -- echo \"hi\"</code></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>Just like in docker, you can use -i &#x26; -t (-it) flags to launch an interactive shell inside the container.</p>\n</blockquote>\n</li>\n<li>\n<p><strong>Kubectl logs</strong></p>\n<p>Print the logs for a container in a pod or specified resource. If the pod has only one container, the container name is optional.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ kubectl logs [-f] [-p] (POD | TYPE/NAME) [-c CONTAINER]</code></pre></div>\n<table>\n<thead>\n<tr>\n<th><strong>Option</strong></th>\n<th align=\"center\"><strong>Shortcut</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Exampe</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--container</td>\n<td align=\"center\">-c</td>\n<td>Prints a container log</td>\n<td><code class=\"language-text\">kubectl logs example -c cname</code></td>\n</tr>\n<tr>\n<td>--follow</td>\n<td align=\"center\">-f</td>\n<td>Real time logs</td>\n<td><code class=\"language-text\">kubectl logs -f example</code></td>\n</tr>\n<tr>\n<td>--tail</td>\n<td align=\"center\"></td>\n<td>Print last X logs (default -1)</td>\n<td><code class=\"language-text\">Kubectl logs --tail 100 example</code></td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n<h2 id=\"resources\" style=\"position:relative;\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resources</h2>\n<p>Every application running inside a kubernetes cluster is deployed by creating a set of resources that interact with each other and make the application accesible to the outside world.</p>\n<p>Those resources can be of many <strong>types</strong>, each one performs a specific task inside the cluster. They can be created declaratively through <strong>manifests</strong> files. There is not a certain number of resources, since they are retrieved from the Kubernetes API, which is extensible. However, Kubernetes natively provides a set of resources that are pre-defined in the endpoints of Kubernetes API, check the <a href=\"#kubernetes-api\">Kubernetes API</a> section containing some of the most commonly used.</p>\n<blockquote>\n<p>A resource is an endpoint in the <strong>Kubernetes API</strong> that stores a collection of API objects of a certain kind; for example, the built-in pods resource contains a collection of Pod objects.</p>\n</blockquote>\n<h3 id=\"manifests\" style=\"position:relative;\"><a href=\"#manifests\" aria-label=\"manifests permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manifests</h3>\n<p>Manifests are files that describes the <strong>properties</strong> of a certain resource type. They can be written in <strong>YAML</strong> or <strong>JSON</strong> format, and vary depending on the resource type. Since many applications require multiple resources to be created, their properties can be simplified by writting the resources in the same file separated by <code class=\"language-text\">---</code> lines. The following example shows how to deploy an nginx container in a pod with a LoadBalancer service to allow connections fron outside the cluster:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>nginx<span class=\"token punctuation\">-</span>svc\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> LoadBalancer\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n<span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>nginx\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> nginx\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> nginx\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx<span class=\"token punctuation\">:</span>1.14.2\n        <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span></code></pre></div>\n<p>Resources can be created through manifests using <code class=\"language-text\">kubectl apply -f &lt;manifest></code> command.</p>\n<blockquote>\n<p>It is a recommended practice to put resources related to the same microservice or application tier into the same file, and to group all of the files associated with your application in the same directory. If the tiers of your application bind to each other using DNS, you can deploy all of the components of your stack together</p>\n</blockquote>\n<h3 id=\"kubernetes-api\" style=\"position:relative;\"><a href=\"#kubernetes-api\" aria-label=\"kubernetes api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kubernetes API</h3>\n<p>The kubernetes API provides a set of endpoints that allow you to interact with the resources in the cluster. The API is extensible, and new resources can be added to it. The following resources comes pre-defined in the Kubernetes API and are the most commonly used for any application deployment:</p>\n<details>\n<summary><b>&emsp;Pods</b></summary><div style=\"padding-left: 30px\"> \n<p>A pod is a collection of containers that are deployed on a node, it may be composed of only one container, or many directly connected containers in some advanced scenarios. Pods run inside a node of the cluster and most of the time are dynamically created by deployments.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/105551703572486b458f86232924f5f7/4654d/pods.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACF0lEQVQoz3WS3W/TMBTF+68jxAsgTYK/AAQv7AUhrWIrTOrDKAXWQtf1Q6xdWbs2SdV82LFjO+4O10m3lY9GOlIs/3x8j++t3Nzc4H/a9e3ib1UZDgbY1qDfR7/XgzEGw+EQ9XodjUYDrVYLYRjeMU5/n3WqOMgpcooicM4LrddrCCEwn88xnU7h+z6UUiXDWMHEcVye23g4VbajWDJZLBbwPB9Zpv6J7vatXSMIAmK8kinO3jMVVwlLEmQyhcokut0OvjQbSOIQRqtiT2uDNE0hBYdWGUXroUnMMvCRGw3GkqL6wjDPc4IFQm7xc3wFngF6DUymHuYBg6JFksQUXyJOLca/Zoh4DkuHr64DzBYhRGZpPy0Nrc0RxRyHHY3HVYZqK0VrJPGsxvHqRMAPFV3IKIHAh67Cg7cM704lWhcCT6oce+9TXC8zGCXvDVchR3OU43XT4mSoMJgp7J9aHHZzLCMy5IziCnwdGbz8bNG4yHE+kXjzLcc+yVtJeootwzCiCs8MHh5oVNsZvl8qPD3SePFJIwhLQ1fhcU/j0YFCtWPQphR7NY3nHxXmyz8MLeKEoT0xqP7QZKYx9gyOzjRVa7BKFI0Ig6CmdKcl49hLT6NGzPG5oWfJqOOiNHSj4TooUuqg5BQtLdaK/jPqKqOZc5MgpaRKHVOyYsMoWjvGNbcwvJsxqjQn2Y3yjbZncRfjLryd5d9Y0IjwBtAu7AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"pods\" title=\"pods\" src=\"/static/105551703572486b458f86232924f5f7/c1b63/pods.png\" srcset=\"/static/105551703572486b458f86232924f5f7/5a46d/pods.png 300w,\n/static/105551703572486b458f86232924f5f7/0a47e/pods.png 600w,\n/static/105551703572486b458f86232924f5f7/c1b63/pods.png 1200w,\n/static/105551703572486b458f86232924f5f7/d61c2/pods.png 1800w,\n/static/105551703572486b458f86232924f5f7/4654d/pods.png 2392w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<p>The following manifest file describes a pod that contains a single container running nginx:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> static<span class=\"token punctuation\">-</span>web\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> web\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> nginx\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> web\n          <span class=\"token key atrule\">containerPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP</code></pre></div>\n<blockquote>\n<p>Note that the apiVersion field indicates \"v1\". The apiVersion depends on the type of resource, run <code class=\"language-text\">kubectl api-resources</code> to see the list of available resources and their api group.</p>\n</blockquote>\n</div>\n</details>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;ReplicaSet</b></summary><div style=\"padding-left: 30px\"> \n<p>The ReplicaSet manage a number of Pods and guarantees that a specified number of Pods are running at any given time. Despite being a step further than pods, ReplicaSets are not meant to be used directly, just like pods, since deployments are a higher level solution capable of manage ReplicaSets.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ReplicaSet\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> example\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">tier</span><span class=\"token punctuation\">:</span> example\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">tier</span><span class=\"token punctuation\">:</span> example\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> example\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> example/example</code></pre></div>\n<blockquote>\n<p>Note that ReplicaSet manifests are really similar to Pods'. They both include specs for the containers to be deployed, but ReplicaSets additionally includes a field for the replicas that will be created, and a selector to match other pods that could be managed.</p>\n</blockquote>\n</div></details>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;Deployments</b></summary><div style=\"padding-left: 30px\"> \n<p>The deployment resource manage Pods and ReplicaSets by providing declarative updates. It is a higher level resource than ReplicaSets, since it is able to manage them. ReplicaSet should not be managed directly, instead they are managed through the Deployment resource. Typical use cases for deployments include deploying ReplicaSets, declaring new state for Pods, roll back to previous state, horizontal scaling, etc.</p>\n<blockquote>\n<p>Deployments manifests file are the same as ReplicaSet manifests, but specifying the kind Deployment instead of ReplicaSet.</p>\n</blockquote>\n</div></details>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;Namespaces</b></summary><div style=\"padding-left: 30px\"> \n<p>Namespaces are used to organize resources in the cluster. They segregate resources into different namespaces, and provide isolation between different applications. Once a namespace is created, it can be used under the <code class=\"language-text\">metadata.namespace</code> field of those resources which are namespaced (see <a href=\"https://kubernetes.io/docs/reference/kubectl/overview/#resource-types\">kubernetes api-resources</a>).</p>\n<p>In order to create a new namespace, run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ kubectl create namespace <span class=\"token operator\">&lt;</span>namespace<span class=\"token operator\">></span></code></pre></div>\n<blockquote>\n<p>When executing kubectl commands on namespaced resources, remember to add the <code class=\"language-text\">-n</code> flag to specify the namespace. All namespaced resources are removed when the namespace is deleted.</p>\n</blockquote>\n</div></details>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;Services</b></summary><div style=\"padding-left: 30px\"> \n<p>Services describe how an application (a set of pods) is accessed, and how it is exposed to the outside world. Services can expose ports and even provide a load balancer. This way, service discovery is automatically provided by kubernetes, giving the pods its own IP address and a DNS name.</p>\n<p>Since pods are being destroyed and redeployed, there is no way to know which IP address each pod has at the time. That is why we use services.</p>\n<blockquote>\n<p>In Kubernetes, a Service is an abstraction which defines a logical set of Pods and a policy by which to access them (sometimes this pattern is called a micro-service). The set of Pods targeted by a Service is usually determined by a selector.</p>\n</blockquote>\n<p>A serice can be defined through this manifest file:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>service\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> ClusterIP <span class=\"token punctuation\">|</span> NodePort <span class=\"token punctuation\">|</span> LoadBalancer <span class=\"token punctuation\">|</span> ExternalName <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> MyApp\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> http\n      <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> TCP\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1234</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30000</span> <span class=\"token comment\"># If type == NodePort</span></code></pre></div>\n<p>Depending on the type of service, the service can perform different tasks inside the cluster:</p>\n<ul>\n<li><strong>ClusterIP:</strong> Exposes the Service on a cluster-internal IP. Choosing this value makes the Service only reachable from within the cluster. This is the default <em>ServiceType</em>.</li>\n<li><strong>NodePort:</strong> Exposes the Service on each Node's IP at a static port (the NodePort). A ClusterIP Service, to which the NodePort Service routes, is automatically created. You'll be able to contact the NodePort Service, from outside the cluster, by requesting <code class=\"language-text\">&lt;NodeIP>:&lt;NodePort></code>.</li>\n<li><strong>LoadBalancer:</strong> Exposes the Service externally using a cloud provider's load balancer. NodePort and ClusterIP Services, to which the external load balancer routes, are automatically created.</li>\n<li><strong>ExternalName:</strong> <em>(Needs Kube-dns >= 1.7 or CoreDNS >= 0.0.8)</em> Maps the Service to the contents of the externalName field (e.g. foo.bar.example.com), by returning a CNAME record with its value. No proxying of any kind is set up.</li>\n</ul>\n<blockquote>\n<p>Kubernetes by default restricts nodePort port range to 30000-32767. This behaviour can be configured by setting the <code class=\"language-text\">--service-node-port-range</code> flag in the kubeapi-server.yaml file. In case you run a cluster locally with Docker, check <a href=\"https://stackoverflow.com/questions/64758012/location-of-kubernetes-config-directory-with-docker-desktop-on-windows\">this site</a> to find where the kubeapi-server.yaml file is located.</p>\n</blockquote>\n<p>When declaring a service, we should know what ports are we going to use to connect our application to the service. That's why is important to know the differences between <code class=\"language-text\">port</code>, <code class=\"language-text\">targetPort</code> and <code class=\"language-text\">nodePort</code> fields.</p>\n<ul>\n<li><strong>Port:</strong> Cluster port to which the service will be listening.</li>\n<li><strong>TargetPort:</strong> Port where the application inside a container is actually running.</li>\n<li><strong>NodePort:</strong> Port Mapping to be exposed outside the cluster.</li>\n</ul>\n<blockquote>\n<p><strong>Example:</strong> If we hace an app running on port 8080 on the container, and we specify Port = 8085, TargetPort = 8080 and NodePort = 30000, the service will be exposed outside the cluster at <code class=\"language-text\">&lt;NodeIP>:30000</code>. Then, port 30000 will be mapped to service port 8085 and the service will redirect the traffic to the port 8080 of the container.</p>\n</blockquote>\n<p>The following picture sums up the behaviour of each service type.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51a6b916384acbdafebe45707b84bc27/c1b63/services.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 116.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsTAAALEwEAmpwYAAADC0lEQVQ4y31UW08TQRjdP6vx8jOMxqiJUeKLBh80wUvQFzFQA0hABaQREEMtUEAorb1su7MzO7s7t/XMzNr2RSfbyVzOme92vgbFv4dxw6+1MUpplnApsSyEMlKZ4P9kpTVwShd5nuX2p7IsL0y+Wc+2G1mAZ0afs2Dn9kANqAYddsBUynyoksMLgatGW2Cd5jrNTZDLQqrySzMhpGXvNPJ6E1AjpMZzuLozO5zbYLhaqCa3Xw0Bw3mAizIqrYcxH/ksNU6s2x5AuUzSnNCE8QxrnCAcS4ZjGHun4spU/6hlL3CC85Ksy1gOmhawfyacJQsIhH3YXnYjMbtGIqbc1owtaw8wAypnV0kvEj6bIAZ49dMe3W2wQZwtVgc0EVs/6WaNGWtfozxYbOwn1TqNEwHAMM52jtjnH8zGnEtzY2Y485HVzsTVqfC0Ix/P03tvCJLvyQDdeR1NV1ijLa9MhUjksyV262XkYzbdCIWxqF8diYr1icKHqEqyLrANiULZ8TRmgHtEKS8SX+H1IzG9yreOhU+YNk5h2lr2Ga2eiOk1DpinWLebA9pzFerF6rAtQ6cNp0pLxPujLa4OWrIf2wwrJZTMgu9n3dPu0D0GGnyzrirnLmYJiblhvTTKadymkCeE0TCYVHLCs7/r8sRG/O8ReF1bDbGk0+lyziefmyTHMQ37IaVsTB4Jm6eCsSTNrMJQj/OejdaGoMfKJyRmPAfg8EIi805hzkn0QLOb+sSCfIKyOTJovucQazvMhVPcUUtAyJbspbt7nF960DtolpWYlKcH1M7F5Yd9tIDv3EltqzDK5jeHMYNX1uZkYziAJDR/vx6GUQpwqW34WdmiWwe8T+S7LxFJ1KcfyfL2WNswsryTrO9z9MzcRhwS+bXOF78lIFrLN19EMysMObj+KDzvySfz9P5bUkw0xt035GmF/urKa4/CRks+X2K3X0XSk2mqeW578PfQYpPMsNS3pCVjgS0OlQNgdgBt3R79ey3spg8q7MNe5vNhTPnvWcqgKOa20/sVtlIbA/4AFE0d+fp9tjwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"services\"\n        title=\"services\"\n        src=\"/static/51a6b916384acbdafebe45707b84bc27/c1b63/services.png\"\n        srcset=\"/static/51a6b916384acbdafebe45707b84bc27/5a46d/services.png 300w,\n/static/51a6b916384acbdafebe45707b84bc27/0a47e/services.png 600w,\n/static/51a6b916384acbdafebe45707b84bc27/c1b63/services.png 1200w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</div></details>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;PersistentVolumes</b></summary><div style=\"padding-left: 30px\"> \n<p>A PersistentVolume (PV) is a piece of storage in the cluster that has been provisioned by an administrator or dynamically provisioned using Storage Classes. It is a resource in the cluster just like a node is a cluster resource. PVs are volume plugins like Volumes, but have a lifecycle independent of any individual Pod that uses the PV. This API object captures the details of the implementation of the storage, be that NFS, iSCSI, or a cloud-provider-specific storage system.</p>\n<p>In order to be used, Persistent Volumes needs match a Persistent Volume Claim (PVC) so the space declared in the PV is claimed. This is called <strong>Static Provisioning</strong>. When none of the statically created PV match a PVC, the cluster try to <strong>dynamically provision</strong> a volume specially for the PVC.</p>\n<p>The following manifests describes a persistent volume that tries to bind to a PVC. This example shows how to <strong>Reserve a Persistent Volume</strong>, meaning that this PV will only bind to the PVC indicated in the claimRef field:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> PersistentVolume\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> foo<span class=\"token punctuation\">-</span>pv\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">capacity</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 5Gi\n  <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ReadWriteOnce\n  <span class=\"token key atrule\">storageClassName</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token key atrule\">claimRef</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> foo<span class=\"token punctuation\">-</span>pvc\n    <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> foo</code></pre></div>\n<p><strong>Access Modes</strong> are an important field since it defines how the volume will be accessed:</p>\n<ul>\n<li><strong>ReadWriteOnce</strong>: The volume can be mounted as read-write by a single node.</li>\n<li><strong>ReadOnlyMany</strong>: The volume can be mounted by multiple nodes read-only.</li>\n<li>\n<p><strong>ReadWriteMany</strong>: The volume can be mounted by multiple nodes read-write.</p>\n</div></details>\n</li>\n</ul>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;PersistentVolumeClaim</b></summary><div style=\"padding-left: 30px\"> \n<blockquote>\n<p>Check the Persistent Volume section above for more information about Persistent Volumes.</p>\n</blockquote>\n<p>A <strong>PersistentVolumeClaim (PVC)</strong> is a request for storage by a user. It is similar to a Pod. Pods consume node resources and PVCs consume PV resources. Pods can request specific levels of resources (CPU and Memory). Claims can <strong>request specific size and access modes</strong>, but they doesn't really need the existence of a PV matching them, since the cluster will <strong>dynamically provision</strong> a new PV.</p>\n<p>The following example manifest will create a PVC requesting 20Gi of storage with <strong>ReadWriteOnce</strong> access mode, if any existing PV matches the requirements then they will be bound together, else a new PV will be dynamically provisioned.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> PersistentVolumeClaim\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n  <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>app\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> simple<span class=\"token punctuation\">-</span>db\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ReadWriteOnce\n  <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 20Gi</code></pre></div>\n</div></details>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;ConfigMaps</b></summary><div style=\"padding-left: 30px\"> \n<p>A ConfigMap is an API object used to store non-confidential data in key-value pairs. Pods can consume ConfigMaps as environment variables, command-line arguments, or as configuration files in a volume.</p>\n<p>A ConfigMap allows you to decouple environment-specific configuration from your container images, so that your applications are easily portable.</p>\n<blockquote>\n<p><strong>Caution</strong>: ConfigMap does not provide secrecy or encryption. If the data you want to store are confidential, use a <strong>Secret</strong> rather than a ConfigMap, or use additional (third party) tools to keep your data private.</p>\n</blockquote>\n<p>You can write a Pod spec that refers to a ConfigMap and configures the container(s) in that Pod based on the data in the ConfigMap. The Pod and the ConfigMap must be in the same namespace.</p>\n<blockquote>\n<p><strong>Note</strong>: The spec of a static Pod cannot refer to a ConfigMap or any other API objects.</p>\n</blockquote>\n<p>Here's an example ConfigMap that has some keys with single values, and other keys where the value looks like a fragment of a configuration format.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> ConfigMap\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> game<span class=\"token punctuation\">-</span>demo\n<span class=\"token key atrule\">data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># property-like keys; each key maps to a simple value</span>\n  <span class=\"token key atrule\">player_initial_lives</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3\"</span>\n  <span class=\"token key atrule\">ui_properties_file_name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"user-interface.properties\"</span>\n\n  <span class=\"token comment\"># file-like keys</span>\n  <span class=\"token key atrule\">game.properties</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n    enemy.types=aliens,monsters\n    player.maximum-lives=5    </span>\n  <span class=\"token key atrule\">user-interface.properties</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n    color.good=purple\n    color.bad=yellow\n    allow.textmode=true   </span></code></pre></div>\n<p>There are four different ways that you can use a <strong>ConfigMap</strong> to configure a container inside a Pod:</p>\n<ul>\n<li>Inside a container command and args</li>\n<li>Environment variables for a container</li>\n<li>Add a file in read-only volume, for the application to read</li>\n<li>Write code to run inside the Pod that uses the Kubernetes API to read a ConfigMap</li>\n</ul>\n<blockquote>\n<p><strong>Note:</strong> When ConfigMaps are configured as volumes mounted by pods, every key insde the config map will transform into a file in the directory where the volume is mounted.</p>\n</blockquote>\n</div></details>\n<!-- ============================================================== -->\n<details>\n<summary><b>&emsp;Secrets</b></summary><div style=\"padding-left: 30px\"> \n<p>Secrets are created the same way as configMaps, but they are used to store confidential data. Secrets don't show their data when <code class=\"language-text\">kubectl get secret &lt;secret></code> is executed instead, they will show the codified data. Just like ConfigMaps, secrets can be configured inside a container command and args, as env variables or as files in a volume.</p>\n</div></details>\n<blockquote>\n<p>Check other resources API like <a href=\"https://projectcontour.io/docs/v1.19.1/\">Project Contour</a> and <a href=\"https://cert-manager.io/docs\">Cert-Manager</a> for managing reverse proxy, web sockets and HTTP over TLS Certificates.</p>\n</blockquote>\n<h2> Conclusion </h2>\n<p>This is the end of this post about kubernetes, eventhough it might seem pretty long, Kubernetes is a very powerful platform that extends <em>reeeeeaally</em> far beyond this post. Feel free to check out the <a href=\"https://kubernetes.io/docs/home/\">Kubernetes documentation</a> and keep learning on one of the most used technologies world wide.</p>"},{"id":"702f9efa-4dfb-5095-9d67-3d3c20abcf29","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"Creating a simple App with NodeJS, ExpressJS and MongoDB","path":"/create-simple-app","tags":["Guide","Beginner","NodeJS","Docker"],"excerpt":"Steps on how to create a simple NodeJS app, connect it to a MongoDB host, expose its data through ExpressJS server and build a Docker image from it.","created":"2022-02-11T00:00:00.000Z","createdPretty":"11 February, 2022","updated":"2022-02-11T00:00:00.000Z","updatedPretty":"11 February, 2022","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVQoz61STU+DQBTkr3vxhP4DY4xn7x70bNI2baQ1EsCDci1ZsGU/2H07dkEIpUo07SQTXnZ484Z9eDgxvOGBtbbmTxjT9gzbFx2JqGbb2JnYpiZLrT2GvY7e2MS+Nqz7PEgopcQ6W0ORQhiGiKIIWuuu2SV2yHiGx+ThYLDkW0hRNgndwSpY4fbuBuf3Z/AvfPiXPuIkBucCjOVgeYFyK5CyD1xPrxAGz4hfX7CYPGE5n+I9DpAmy91g0xi6NJYs5ukEi7cZyg2HqlSdzGnGPY3pPk8KgUopfOYMm6IA7TT61vfu0JCGttXoFi3+seUWbpPDi/8rvb7Zb/VRP/ax+ALHTFzuPSVcigAAAABJRU5ErkJggg==","aspectRatio":1.7857142857142858,"src":"/static/ab98d8eeab250a166555ae868b07a029/0853f/cover.png","srcSet":"/static/ab98d8eeab250a166555ae868b07a029/14156/cover.png 125w,\n/static/ab98d8eeab250a166555ae868b07a029/d6e47/cover.png 250w,\n/static/ab98d8eeab250a166555ae868b07a029/0853f/cover.png 500w,\n/static/ab98d8eeab250a166555ae868b07a029/ce627/cover.png 750w,\n/static/ab98d8eeab250a166555ae868b07a029/9dbcf/cover.png 1000w,\n/static/ab98d8eeab250a166555ae868b07a029/87046/cover.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<blockquote>\n<p>This guide assumes you already know javascript.\nYou can find all the code used throughout this guide <a href=\"https://github.com/alesancor1/Blog-Projects/tree/main/guides/simple-app\">here</a></p>\n</blockquote>\n<h2 id=\"requirements\" style=\"position:relative;\"><a href=\"#requirements\" aria-label=\"requirements permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Requirements</h2>\n<p>In order to perform a full deployment of a simple Node App, we need to first meet the following requirements:</p>\n<ol>\n<li>Install <a href=\"https://nodejs.org/es/download/\">NodeJS and npm</a>.</li>\n<li>Install <a href=\"https://docs.docker.com/engine/install/\">Docker</a> and <a href=\"https://docs.docker.com/compose/install/\">Docker Compose</a>.</li>\n<li>Any SCE or IDE (We will be using VSCode for this guide)</li>\n<li>Git (Not actually needed, but always recommended)</li>\n</ol>\n<blockquote>\n<p>Windows users may be interested in installing <a href=\"https://www.docker.com/get-started\">Docker Desktop</a> since Compose comes already integrated along a single node Kubernetes Cluster</p>\n</blockquote>\n<h2 id=\"first-steps\" style=\"position:relative;\"><a href=\"#first-steps\" aria-label=\"first steps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>First steps</h2>\n<p>Every NodeJS always app starts with a <strong>package.json</strong> file. This file provides basic information and metadata about the project, it is also where dependencies and scripts are defined. The entrypoint to our npm package is defined in the <em>main</em> field of package.json, this way, runing <code class=\"language-text\">npm start</code> will start the app asi if we ran <code class=\"language-text\">node index</code></p>\n<blockquote>\n<p>Many npm packages, such as <em>prettier</em>, <em>snyk</em>, <em>mocha</em> or <em>nyc</em> use the package.json file as a mean to override default configuration. This transform package.json into an important configuration file for many dependencies.</p>\n</blockquote>\n<p>In order to create our first node app, we can simply run <code class=\"language-text\">npm init</code>. This command will prompt some fields that we need to fill for our package.json to generate. When generated, a file named <strong>package-lock.json</strong> will be created, too. Lock files contains the full dependency tree of all packages. Many developers tend to avoid uploading this file to SVNs, it is actually a really good practice to do so, since we ensure everyone cloning or forking our repository will be using the same dependencies.</p>\n<p>We have now generated the basic files in order to start a new NodeJS app or npm package. Now it is time to install some dependencies before start coding.</p>\n<h2 id=\"installing-dependencies\" style=\"position:relative;\"><a href=\"#installing-dependencies\" aria-label=\"installing dependencies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installing dependencies</h2>\n<p>Node comes along with npm, a really powerful package manager that allow developers to download and install libraries that serve as dependencies for other developers' projects. The purpose of this guide is to create a NodeJS application that is able to connect to MongoDB and allow making REST requests to an ExpressJS server. </p>\n<p>Neither of that is natively supported in Node, so here is where npm comes. We will install <a href=\"https://www.npmjs.com/package/express\">ExpressJS</a> and <a href=\"https://www.npmjs.com/package/mongoose\">mongoose</a> through npm for our app to be able to receive clients requests and connect to MongoDB. To install them, run:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install express mongoose</code></pre></div>\n<blockquote>\n<p>You may also find this command along <strong>--save</strong> and <strong>--save-dev</strong> options. --save option is no longer required since by default npm will write the dependencies to the <em>dependencies</em> field of package.json, meaning this packages are <strong>core dependencies</strong> and must be installed for your code to work. On the other hand, --save-dev option tells npm to write the packages to <em>dev_dependencies</em>, meaning that those package are only used for development and therefore not required in production environments.</p>\n<p>Some packages typically installed under <em>dev_dependencies</em> are: Mocha, Nyc, Prettier, EsLint, Snyk... </p>\n</blockquote>\n<p>Once npm has installed the dependencies, we can start coding by creating a new file named <strong>index.js</strong>. This file will be the entrypoint of our app, and will be the first file that will be executed when the app is started.</p>\n<h2 id=\"coding-the-app\" style=\"position:relative;\"><a href=\"#coding-the-app\" aria-label=\"coding the app permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Coding the app</h2>\n<h3 id=\"requiring-dependencies\" style=\"position:relative;\"><a href=\"#requiring-dependencies\" aria-label=\"requiring dependencies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Requiring Dependencies</h3>\n<p>First thing we need to do before start writing code, is to require those dependencies we will need for our purpose. As we said before, this app is meant to connect to mongoDB and expose its data through an ExpressJS server, so we will need to import the ExpressJS and Mongoose libraries. There are two popular ways of importing dependencies depending on the specification our package follows. </p>\n<p>The standard way of importing dependencies has always been to use the <code class=\"language-text\">require</code> function. This standard is known as <strong>CommonJS</strong> and is the most widely used by NodeJS developers. However, since the release of Node 12 (LTS), <strong>ECMA Script</strong>, also known as <strong>ES Modules (ESM)</strong> has been gaining wide support and popularity. ES Modules use the <code class=\"language-text\">import</code> syntax, which allows to load modules synchronously and asynchronously with a more readable syntax.</p>\n<blockquote>\n<p>Since CommonJS is the most popular for now, we will be using this specification for our simple project. A future post will describe in depth the pros and cons of both specifications when it comes to NodeJS development.</p>\n</blockquote>\n<p>That being said, we can now import our packages using the <strong>require</strong> function:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Index.js</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> mongoose <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mongoose'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"environment-variables\" style=\"position:relative;\"><a href=\"#environment-variables\" aria-label=\"environment variables permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Environment Variables</h3>\n<p>In order to connect to MongoDB, it is a good practice to define environment variables. This way, we can change the host and port of MongoDB without having to change the code. </p>\n<blockquote>\n<p><strong>tip:</strong> Hard-coding some values in the code may lead to critical security issues, hard maintenance and potential bugs. Always try to make your code as easy to maintain as possible. Sensitive data like passwords or tokens <strong>MUST NEVER</strong> be present in the code.</p>\n</blockquote>\n<p>We will be declaring environment variables for the configuration needed to connect to the database, apart from the port in which our app will be running:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Index.js</span>\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">32000</span>\n<span class=\"token keyword\">const</span> mongoHost <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_HOST</span> <span class=\"token operator\">||</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> mongoPort <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_PORT</span> <span class=\"token operator\">||</span> <span class=\"token string\">\"27017\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> mongoDBName <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">DB_NAME</span> <span class=\"token operator\">||</span> <span class=\"token string\">'simple-db'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Note that we are using the <strong>OR operator</strong> ' || ' to define default values for the environment variables, this will allow us to run the app locally without having to specify the values for the environment variables.</p>\n<h3 id=\"writting-a-mongoose-model\" style=\"position:relative;\"><a href=\"#writting-a-mongoose-model\" aria-label=\"writting a mongoose model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Writting a mongoose model</h3>\n<p>For storing data in our database, we first need to provide a <strong>Schema</strong> that defines how this data is actually structured. This Schema will be used to create a Mongoose model. We are going to create a 'Log' model, consisting on the <strong>timestamp</strong> and the <strong>user-agent</strong> of the client request.</p>\n<p>Create a new file named <strong>Log.js</strong> under a directory named <strong>models</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Log.js</span>\n<span class=\"token keyword\">const</span> mongoose <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mongoose'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Schema <span class=\"token operator\">=</span> mongoose<span class=\"token punctuation\">.</span>Schema<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> LogSchema <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Schema</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">timestamp</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> Date<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">useragent</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> mongoose<span class=\"token punctuation\">.</span><span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Log'</span><span class=\"token punctuation\">,</span> LogSchema<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Don't forget to export the model so that we can use it in other files.</p>\n<h3 id=\"creating-and-configuring-express-server\" style=\"position:relative;\"><a href=\"#creating-and-configuring-express-server\" aria-label=\"creating and configuring express server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating and configuring Express server</h3>\n<p>Creating a express server is as simple as creating a new instance of the ExpressJS class. We will declare a new constant named <strong>app</strong> and assign it to the new ExpressJS instance:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Index.js</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>With the ExpressJS instance created, we can now start configuring our app. First thing we will do is configure an endpoint that receives GET requests to the root of our app. This endpoint will store the timestamp and the user-agent of the client request in the database and will return all the stored logs right after.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> newLog <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">timestamp</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">useragent</span><span class=\"token operator\">:</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'Unknown'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    newLog<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        Log<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">logs</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>logs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Server error'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n        res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unknown error'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>Express and mongoose functions are asyncronous and therefore return <strong>promises</strong>. We can use the <strong>then</strong> function to handle the success case and the <strong>catch</strong> function to handle the error case. You will find more about promises in future posts.</p>\n</blockquote>\n<h3 id=\"connecting-to-mongo-and-starting-the-server\" style=\"position:relative;\"><a href=\"#connecting-to-mongo-and-starting-the-server\" aria-label=\"connecting to mongo and starting the server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connecting to Mongo and starting the server</h3>\n<p>Once created our database model and configured the endpoints for the express server, it is time to connect and start listening to a port. Since this app fully relies on MongoDB to work, we will code this in a way to force mongoose to connect before starting the server. We can easily do that thanks to <strong>then</strong> function of promises.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> mongoURL <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">mongodb://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mongoHost<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mongoPort<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mongoDBName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\nmongoose<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>mongoURL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span> <span class=\"token parameter\">resp</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    app<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Connected! Simple app listening on port </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Could not connect to db\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Don't forget to handle possible connection errors or Node process will prompt a hardly readable message.</p>\n<h2 id=\"running-the-app-locally\" style=\"position:relative;\"><a href=\"#running-the-app-locally\" aria-label=\"running the app locally permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running the app locally</h2>\n<p>Thanks to default values declared for the environment variables, we just need to set up a MongoDB instance and run <code class=\"language-text\">npm start</code> to start the app. You can easily deploy a mongo container with docker:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker run --name mongo -p 27017:27017 -d mongo:latest </code></pre></div>\n<p>If you performed all the steps correctly, you should be able to access the app at <a href=\"http://localhost:32000/\">http://localhost:32000/</a> in your browser. You will see a log each time you reload the page:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9ef6720f251a6380ebc9eb3754a8cb39/9f9a4/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAlElEQVQI142KQQrCMBREe66CiAiKYLEoKIgr3XlUNU3yk1ZQakn7k7Sp+7r0ewOHxyzeTLQ+npPDaZru4tkynif/MFqsJul2vNlHlxu7Ms5BZUJmErgEqbQgQIPOVV4wLmhSuvh5UHQQAPfH0zgfVWX5qirrLNa1pSB655z31J1vQwi1Mdg0oe1a8tYhIr3eff8Zhi8fNng8Ue+szQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"result\"\n        src=\"/static/9ef6720f251a6380ebc9eb3754a8cb39/c1b63/result.png\"\n        srcset=\"/static/9ef6720f251a6380ebc9eb3754a8cb39/5a46d/result.png 300w,\n/static/9ef6720f251a6380ebc9eb3754a8cb39/0a47e/result.png 600w,\n/static/9ef6720f251a6380ebc9eb3754a8cb39/c1b63/result.png 1200w,\n/static/9ef6720f251a6380ebc9eb3754a8cb39/9f9a4/result.png 1560w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"dockerizing-and-pushing-the-image\" style=\"position:relative;\"><a href=\"#dockerizing-and-pushing-the-image\" aria-label=\"dockerizing and pushing the image permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dockerizing and pushing the image</h2>\n<p>It is a common practice to dockerize the app into an image and push it to a registry before moving to a production environment. Running a docker container in production avoids the need to install the required infrastructure and configuration (NodeJS, npm, mongoDB, etc.) in the remote machine and allows the app to scale dinamically if configured correctly.</p>\n<blockquote>\n<p>Applications based on the microservices architecture are usually deployed in clusters (e.g kubernetes) which relies on Docker containers.</p>\n</blockquote>\n<p>The first step is to create a <strong>Dockerfile</strong> in the root of the project. This Dockerfile will be used to build the image, commonly from another image (NodeJS official image for this example). We indicate the steps needed to run our app following the <a href=\"https://docs.docker.com/engine/reference/builder/\">Dockerfile reference</a>, the result is shown below:</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token comment\"># Dockerfile</span>\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> node:16.13.0-alpine3.14</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> . .</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm install --only=prod</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ARG</span> NODE_ENV=production</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> NODE_ENV <span class=\"token variable\">$NODE_ENV</span></span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [ <span class=\"token string\">\"node\"</span>, <span class=\"token string\">\"index.js\"</span> ]</span></code></pre></div>\n<p>Once the Dockerfile is ready, we can build our image by running the <strong>docker build</strong> command. We will use the <strong>-t</strong> flag to specify the name of the image we want to build.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker build -t alesancor1/simple-app .</code></pre></div>\n<blockquote>\n<p>If you are planning to upload the image to <strong>DockerHub</strong>, you need to specify the tag following the username/app-name format.</p>\n</blockquote>\n<p>Now the image is created and stored in our local machine, for pushing it to DockerHub, we will need to login to DockerHub. To do this, we will use the <strong>docker login</strong> command.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker login -u &lt;username> --password-stdin</code></pre></div>\n<blockquote>\n<p>It is reccommended to use --password-stdin options to avoid typing the password in the command line without any tipe of encryption.</p>\n</blockquote>\n<p>Finally, we can push our docker image to docker hub and indicate a version tag for our app. In this case, I specify the 'latest' version tag.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker push alesancor1/simple-app:latest</code></pre></div>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>This is the end of the guide. If you want to learn more about deploying applications in production environment, check out the <a href=\"http://alesancor1.github.io/kubernetes-fundamentals\">Kubernetes post</a> and <a href=\"http://alesancor1.github.io/helm-fundamentals\">Helm post</a> to learn more about the different tools and techniques used to deploy applications in production.</p>"}],"postsPerPage":5}},"staticQueryHashes":["1116962356","2275848304","444477021","545095672","625280739"]}