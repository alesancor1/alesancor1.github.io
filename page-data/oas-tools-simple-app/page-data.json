{"componentChunkName":"component---node-modules-nehalist-gatsby-theme-nehalem-src-templates-post-tsx","path":"/oas-tools-simple-app/","result":{"data":{"post":{"id":"4e45a680-8af9-5198-befd-784abf9ee9dd","headings":[{"depth":1},{"depth":2},{"depth":3},{"depth":3},{"depth":2}],"frontmatter":{"title":"Creating a simple app with OAS Tools framework","path":"/oas-tools-simple-app/","tags":["Guide","Beginner","NodeJS","Technologies"],"excerpt":"Creating a Node.JS service from scratch, using OAS Tools v3 framework.","created":"2022-11-27T23:10:00.000Z","createdPretty":"27 November, 2022","updated":"2022-11-27T00:00:00.000Z","updatedPretty":"27 November, 2022","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACBUlEQVQoz21SQU8aURDe39L+B2NiYtpebG+evHq3Hjw0ZS+wEBrkIFAoLXGFGEIJvE2oJHIh0LQSEhtoGr0IpXBoN1ZJqSkqYHbZ/brvrYsLcbKTnbdvdub7Zj5O13VQpzbWx8ypWd/uizVNg93o2crhrEDVVCPbTBhqQxYrqjL52d6YWr/fR7fbxWAwmGrGTYoZVhjvY/1sHdJfws7b4jb2cnsm+rGJXFEU5PN5+Hw+uN1uBAIBVKvVu4IWgsOPh3gurYH7zmFH30HjSwMbLzZQr9en6BFCIAgC/H4/cxq7XC7UarVbyppJI7T1GosPF+HOCNh8v4mQEDLg3I5gOECz2YQsy4hEIiiVSigWi8hkMixOp9MIh8NQVdWkfKPcwPPJg/kP8yBfCcgbAv6Yx/KfZexe7eL46BsePX6CzwcHkCSCSqWCQqGAeDyOTqeDVCoFr9fL5smpujm/V5decD85LJ0sIeaJYa46x+iLF6KxRuD0/BS9Xg/BYJAVy+VyRnEJyWQS2WwWiUSCLdDcsvHIQxmrF6t4lniKhQcLWHm5gne9tzhTf0/NsFwuw+FwsLlR53keTqcTrVbLnCHTkW4upotzNH41EI8ZVH50cP3vGta9XXt0AaIoIhqNMoTtdvtuy3ZR32dWs1kt0vdoNJoS90TYFm2GxHCqObv6ZwvZ0c6e/wPvgAGU9TXpwAAAAABJRU5ErkJggg==","aspectRatio":1.9047619047619047,"src":"/static/25eef7088209595024a41a8b0f408f71/90823/cover.png","srcSet":"/static/25eef7088209595024a41a8b0f408f71/dc47e/cover.png 200w,\n/static/25eef7088209595024a41a8b0f408f71/9f2d5/cover.png 400w,\n/static/25eef7088209595024a41a8b0f408f71/90823/cover.png 800w,\n/static/25eef7088209595024a41a8b0f408f71/77647/cover.png 1200w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"html":"<h1 id=\"quickstart\" style=\"position:relative;\"><a href=\"#quickstart\" aria-label=\"quickstart permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Quickstart</h1>\n<h2 id=\"using-the-cli\" style=\"position:relative;\"><a href=\"#using-the-cli\" aria-label=\"using the cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using the CLI</h2>\n<p>The command line interface incorporates the necessary functionality to initialize a REST service from an OpenAPI document as well as to initialize it from an entity resource.</p>\n<p>To initialize the CLI tool, run the following command (without the <code class=\"language-text\">></code> sign):</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">&gt; npx @oas-tools/cli init</code></pre></div>\n<p>It will prompt the following menu, asking which type of resource will be initialized:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">? Select a resource to initialize (Use arrow keys)\n&gt; Server\n  Module\n  Development environment\n  OpenAPI File</code></pre></div>\n<h3 id=\"staring-from-an-entity-resource\" style=\"position:relative;\"><a href=\"#staring-from-an-entity-resource\" aria-label=\"staring from an entity resource permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Staring from an entity resource</h3>\n<p>In order to initialize a REST service from an entity resource, you will first need to generate a valid OpenAPI document. Your entity resource must be written in a YAML or JSON file and should look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"User\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"email\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"user@example.com\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"petName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Garfield\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Cat\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<blockquote>\n<p>Note that in the example above we have declared an array containing two types of resources: A User with id, name and email attributes, and a Pet with id, petName and type attributes. OAS Tools CLI is capable of interpret both resources and generate a valid OpenAPI document. In case only one resource is provided, there is no need to declare it as an array, an object can be directly passed to the CLI, too.</p>\n</blockquote>\n<p>Once your resource file is ready, select the fourth option in the menu prompted after running <code class=\"language-text\">npx @oas-tools/cli init</code> command before.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">? Select a resource to initialize (Use arrow keys)\n  Server\n  Module\n  Development environment\n&gt; OpenAPI File</code></pre></div>\n<p>It will ask you for your resource file, navigate to the directory it is in and select it. Then it will read your file and ask some questions about it.</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\">? Select your resources file '/testResource.json'\n? Choose OpenAPI version '3.1'\n? Enter a title for the described API 'Autogenerated Api'\n? Enter a description for the described API 'Generated with OAS TOOLS CLI'\n? Provide a name for the resource containing {id,name,email} 'User'\n? Which will be the id property for User 'id'\n? Specify which operations will be available for User 'GET, POST, PUT, DELETE'\n? Provide a name for the resource containing {id,petName,type} 'Pet'\n? Which will be the id property for Pet 'id'\n? Specify which operations will be available for Pet 'POST, DELETE'\n? Choose the preferred format for the OpenAPI Document 'YAML'\n? Where will be file generated? 'oas-doc.yaml'\n? Generate file with this options? (Y/n)</code></pre></div>\n<p>Once all the question has been answered, a new OpenAPI file will be generated with the name specified. After that, follow the steps in the section below to generate a server from the OpenAPI declaration.</p>\n<h3 id=\"starting-from-the-openapi-document\" style=\"position:relative;\"><a href=\"#starting-from-the-openapi-document\" aria-label=\"starting from the openapi document permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Starting from the OpenAPI document</h3>\n<p>Having a valid OpenAPI document, select the first option in the menu prompted after running <code class=\"language-text\">npx @oas-tools/cli init</code> command:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">? Select a resource to initialize (Use arrow keys)\n&gt; Server\n  Module\n  Development environment\n  OpenAPI File</code></pre></div>\n<p>It will ask the following questions about the generated server:</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\">? Where will be files generated? 'generated-server'\n? Port in which the server will be listening '8080'\n? Specify the path to the OpenAPI Document 'oas-doc.yaml'\n? Choose the preferred format for the OpenAPI Document 'YAML'\n? Dereference OpenAPI document? 'No'\n? Choose the preferred Javascript convention for your server 'ECMAScript Modules (ESM)'\n? Will the server run inside a container? 'Run normally'\n? Compress files in ZIP and delete? 'No'\n? Generate server with this options? (Y/n)</code></pre></div>\n<p>Once the server is generated, you can <code class=\"language-text\">cd &lt;generated-server></code> and run:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">&gt; npm start</code></pre></div>\n<h2 id=\"without-using-the-cli\" style=\"position:relative;\"><a href=\"#without-using-the-cli\" aria-label=\"without using the cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Without using the CLI</h2>\n<p>Assume the following OpenAPI document, save it to <code class=\"language-text\">oas-file.yaml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">openapi</span><span class=\"token punctuation\">:</span> 3.0.0\n<span class=\"token key atrule\">info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> 1.0.0\n  <span class=\"token key atrule\">title</span><span class=\"token punctuation\">:</span> Quickstart\n  <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> Quickstart for OAS<span class=\"token punctuation\">-</span>Tools\n<span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">/api/v1/entity</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">get</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">x-router-controller</span><span class=\"token punctuation\">:</span> EntityController\n      <span class=\"token key atrule\">operationId</span><span class=\"token punctuation\">:</span> getEntity\n      <span class=\"token key atrule\">responses</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">'200'</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> Success\n          <span class=\"token key atrule\">content</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">application/json</span><span class=\"token punctuation\">:</span>\n                <span class=\"token key atrule\">schema</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token key atrule\">$ref</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'#/components/schemas/entity'</span>\n<span class=\"token key atrule\">components</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">schemas</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">entity</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> object</code></pre></div>\n<p>Start by creating a new Node.js project and install express and OAS Tools core:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">&gt; npm init\n&gt; npm install --save express @oas-tools/core</code></pre></div>\n<blockquote>\n<p>If you want to use ESM syntax, insert <code class=\"language-text\">\"type\": \"module\"</code> at the root level into the generated <code class=\"language-text\">package.json</code>. Note that OAS Tools is compaible with both, ESM/import and CommonJS/require syntax.</p>\n</blockquote>\n<p>Place your OpenAPI document under <code class=\"language-text\">/api/oas-file.yaml</code>, and create <code class=\"language-text\">index.js</code> and <code class=\"language-text\">controllers/EntityController.js</code>. </p>\n<p>Your file structure should look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">server\n  ├── api\n  |   └── oas-file.yaml\n  ├── controllers\n  |   └── EntityController.js\n  ├── node_modules\n  |   └── @oas-tools\n  |       └── core\n  ├── index.js\n  ├── package.json\n  └── package-lock.json</code></pre></div>\n<p>Open <code class=\"language-text\">controllers/EntityController.js</code> and export a function with the same name as the <code class=\"language-text\">operationId</code> specified in the OpenAPI document:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//EntityController.js</span>\n\nmodule<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getEntity</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">entity</span><span class=\"token operator\">:</span> <span class=\"token string\">\"This is an entity object\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Finally, create the server entrypoint in the <code class=\"language-text\">index.js</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> http <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> oasTools <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@oas-tools/core\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> serverPort <span class=\"token operator\">=</span> <span class=\"token number\">8080</span><span class=\"token punctuation\">;</span>\n\noasTools<span class=\"token punctuation\">.</span><span class=\"token function\">initialize</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    http<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>serverPort<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Server started!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Once everything is done, run <code class=\"language-text\">node index</code> and open <a href=\"http://localhost:8080/docs\">your new server docs</a> in your browser.</p>"},"primaryTag":{"name":"Guide","color":"#007acc"}},"pageContext":{"postId":"4e45a680-8af9-5198-befd-784abf9ee9dd","primaryTag":"Guide"}},"staticQueryHashes":["1116962356","2275848304","545095672","625280739"]}